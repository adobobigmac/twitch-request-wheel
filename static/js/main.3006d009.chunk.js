(this["webpackJsonptwitch-bot"]=this["webpackJsonptwitch-bot"]||[]).push([[0],{32:function(e,t){},45:function(e,t,n){},46:function(e,t,n){},50:function(e,t,n){},58:function(e,t){},80:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(2),s=n.n(a),c=n(34),i=n.n(c),r=n(18),o=(n(45),n(9)),l=n(10),u=n(12),d=n(11),h=(n(46),n(27)),p=n.n(h),j=n(5),b=n(35),m=n(39),f=n(19),g=n(36),O=n(40),x=(n(50),n.p+"static/media/lock.6857c469.svg"),v=n(3),y=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).updateTimeDiff=function(){a.setState((function(){return Object(j.a)(Object(j.a)({},a.state),{},{timeDiff:"".concat(Math.floor((Date.now()-a.props.metadata.time)/6e4)," minutes ago")})}))},a.delete=function(e){a.props.onDelete(a.props.msg)},a.toggleLock=function(){a.props.toggleLock(a.props.msg)},a.state={timeDiff:0},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.metadata.locked?"1":"0.2";return Object(v.jsxs)("div",{children:[Object(v.jsx)(O.a,{effect:"solid",place:"right"}),Object(v.jsx)("div",{id:"baseDiv","data-tip":"Requested ".concat(this.state.timeDiff," by ").concat(this.props.metadata.username),style:{backgroundColor:"steelblue",textAlign:"left",borderRadius:"8px",textTransform:"capitalize"},onMouseEnter:this.updateTimeDiff,children:Object(v.jsxs)("p",{style:{margin:"0px 15px 7px",padding:"4px",fontSize:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[this.props.msg,Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("img",{src:x,alt:"lock",style:{width:"16px",opacity:e,paddingRight:"8px"},className:"lock",onClick:this.toggleLock}),Object(v.jsx)("button",{type:"button",className:"deleteButton",onClick:this.delete,children:"X"})]})]})})]})}}]),n}(a.Component),k=n(30),w=n(23),C=n.n(w),G=n.p+"static/media/JackboxGames.0b4c1fc6.yaml",S=n(26),_=n(56),q="!request",M=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).filterGameCommands=function(e,t){if(e.startsWith(q)){var n=e.replace(q,"").trim().toLowerCase();for(var s in a.state.validGames)for(var c=a.state.validGames[s],i=0,r=Object.entries(c);i<r.length;i++){var o=Object(k.a)(r[i],2),l=o[0];if(o[1].includes(n))return"".concat(l," (").concat(s,")")}return a.sendMessage("/me @".concat(t,", ").concat(n," could not be found in the list of valid Jackbox games. Click here for a list of valid games: ").concat("https://asukii314.github.io/twitch-request-wheel/#","/gamelist")),null}},a.onMessage=function(e,t,n,s){if(!s){var c=a.filterGameCommands(n,t.username);if(c)if(a.props.messages[c])a.sendMessage("/me @".concat(t.username,", ").concat(c," has already been requested!"));else{for(var i=null,r=0,o=Object.entries(a.props.messages);r<o.length;r++){var l=Object(k.a)(o[r],2),u=l[0];if(l[1].username===t.username){i=u;break}}i?a.props.channel===t.username?a.sendMessage("/me @".concat(t.username,", ").concat(c," has been added to the request queue. Your previous game request(s) weren't deleted, since you have special broadcaster privilege :P")):(a.removeGame(i),a.sendMessage("/me @".concat(t.username,", your previous request of ").concat(i," has been replaced with ").concat(c,"."))):a.sendMessage("/me @".concat(t.username,", ").concat(c," has been added to the request queue.")),a.props.addGame(c,t.username)}}},a.sendMessage=function(e){a.state.client.say(a.props.channel,e)},a.state={client:null,validGames:[]},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(e){var t=this,n=new _.client({identity:{username:this.props.channel,password:this.props.access_token},channels:[this.props.channel]});n.on("message",this.onMessage),n.connect(),S(G).then((function(e){return e.text()})).then((function(e){t.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{client:n,validGames:C.a.parse(e)})}))}))}},{key:"render",value:function(){return null}}]),n}(a.Component),D=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).goForward=function(){a.state.index!==a.props.history.length-1&&a.setState((function(e){return Object(j.a)(Object(j.a)({},a.state),{},{index:a.state.index+1})}))},a.goBackward=function(){a.state.index<=0||a.setState((function(e){return Object(j.a)(Object(j.a)({},a.state),{},{index:a.state.index-1})}))},a.printGame=function(e){return e===a.state.index?Object(v.jsx)("b",{style:{color:"aquamarine"},children:a.props.history[e]}):a.props.history[e]},a.state={index:0},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{style:{marginLeft:"12px",width:"33%",textTransform:"capitalize"},children:[Object(v.jsx)("div",{style:{backgroundColor:"darkslategrey",borderRadius:"5px",marginTop:0,padding:"1px",marginBottom:"10px"},children:Object(v.jsxs)("p",{style:{fontSize:"14px",fontWeight:"700",height:"70px",padding:"8px"},children:[" Up Next:",this.props.history.length>this.state.index&&Object(v.jsx)("p",{children:this.props.history[this.state.index]})]})}),Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(v.jsx)("button",{onClick:this.goBackward,style:{backgroundColor:"darkcyan",borderRadius:"5px",marginTop:0,width:"50%",marginBottom:"20px",marginRight:"5px"},children:" \ud83e\udca0 "}),Object(v.jsx)("button",{onClick:this.goForward,style:{backgroundColor:"darkcyan",borderRadius:"5px",marginTop:0,width:"50%",marginBottom:"20px",marginLeft:"5px"},children:" \ud83e\udca1 "})]}),Object(v.jsxs)("div",{style:{backgroundColor:"darkslategrey",borderRadius:"5px",marginTop:0,padding:"5px"},children:[Object(v.jsx)("p",{style:{fontSize:"14px",fontWeight:"700"},children:" History "}),Object(v.jsxs)("p",{style:{fontSize:"12px"},children:[this.props.history.map((function(t,n){return Object(v.jsx)("li",{children:e.printGame(n)},n)})),0===this.props.history.length&&Object(v.jsx)("li",{children:"No games yet"},"0")]})]})]})}}]),n}(a.Component),N=n(72),T=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).addGame=function(e,t){a.setState((function(n){return Object(j.a)(Object(j.a)({},n),{},{messages:Object(j.a)(Object(j.a)({},a.state.messages),{},Object(f.a)({},e,{username:t,time:Date.now(),locked:!1})),counter:a.state.counter+1})}))},a.toggleLock=function(e){var t=Object(j.a)({},a.state.messages[e]);t.locked=!t.locked,a.setState((function(){return Object(j.a)(Object(j.a)({},a.state),{},{messages:Object(j.a)(Object(j.a)({},a.state.messages),{},Object(f.a)({},e,t))})}))},a.onGameChosen=function(e){0!==Object.keys(a.state.messages).length&&(a.state.messages[e].locked||setTimeout((function(){a.removeGame(e,!0)}),2500),a.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{history:[].concat(Object(m.a)(a.state.history),[e])})})))},a.removeGame=function(e){var t=Object(j.a)({},a.state.messages);delete t[e],a.setState((function(e){return Object(j.a)(Object(j.a)({},e),{},{messages:t,counter:a.state.counter+1})}))},a.state={messages:{},colors:N({count:99,luminosity:"light",hue:"blue"}),counter:0,history:[]},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=Object.keys(this.state.messages);return Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)(M,{addGame:this.addGame,messages:this.state.messages,channel:this.props.channel,access_token:this.props.access_token}),Object(v.jsxs)("column",{width:"50vw",children:[Object(v.jsx)("h2",{style:{marginBottom:"0"},children:"Game Requests"}),Object(v.jsxs)("h4",{style:{fontSize:"20px",color:"yellow",marginTop:"6px",marginBottom:"12px",fontWeight:400},children:['Type e.g. "!request Blather Round" in ',this.props.channel,"'s chat to add"]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",height:"100%"},children:[Object(v.jsx)(D,{history:this.state.history}),Object(v.jsx)("div",{style:{flexGrow:"2",marginLeft:"15px"},children:t.map((function(t,n){return Object(v.jsx)(y,{msg:t,metadata:e.state.messages[t],onDelete:e.removeGame,toggleLock:e.toggleLock.bind(t)},n)}))})]})]}),Object(v.jsx)("column",{width:"50vw",style:{textTransform:"capitalize"},children:Object(v.jsx)("div",{style:{fontSize:"16px",overflow:"hidden",width:"600px"},children:Object(v.jsx)(g.a,{segments:t,segColors:this.state.colors,onFinished:this.onGameChosen,isOnlyOnce:!1,size:250,upDuration:100,downDuration:1e3,primaryColor:"white",contrastColor:"black"},this.state.counter)})})]})}}]),n}(a.Component),L=n(6),z=n(37),B=n.n(z),R=n(26),P=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).state={username:"",access_token:"",failed_login:!1},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(b.a)(p.a.mark((function e(){var t,n=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=B.a.parse(this.props.location.search),e.next=3,R("https://id.twitch.tv/oauth2/token?"+new URLSearchParams({grant_type:"authorization_code",code:t.code,client_id:"u172q64ekv1j8nxy1r48mb8vn4kk7v",client_secret:"7yfmbc5ka6t7frki5g8m0qsboltp2p",redirect_uri:"https://asukii314.github.io/twitch-request-wheel/#"}),{method:"POST",headers:{Accept:"application/vnd.twitchtv.v5+json"}}).then((function(e){return e.json()})).then((function(e){e.access_token?(n.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{access_token:e.access_token})})),R("https://api.twitch.tv/helix/users",{headers:{"Client-ID":"u172q64ekv1j8nxy1r48mb8vn4kk7v",Authorization:"Bearer ".concat(e.access_token)}}).then((function(e){return e.json()})).then((function(e){n.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{username:e.data[0].login})}))}))):n.setState((function(e){return Object(j.a)(Object(j.a)({},e),{},{failed_login:!0})}))}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(v.jsx)("div",{children:this.state.failed_login&&"/gamelist"!=this.props.location.pathname?Object(v.jsx)(L.a,{to:"/login"}):this.state.username&&Object(v.jsx)(T,{channel:this.state.username,access_token:this.state.access_token})})}}]),n}(a.Component),F=Object(L.f)(P),I=(n(80),n(26)),A=function(e){var t=Object.keys(e.metadata);return Object(v.jsxs)("div",{className:"partyPackCard",children:[Object(v.jsxs)("p",{className:"partyPackName",children:[e.partyPackName," "]}),t.map((function(t,n){return Object(v.jsx)(W,{gameName:t,possibleMatches:e.metadata[t]},n)}))]})},W=function(e){return console.log(e.possibleMatches),Object(v.jsxs)("div",{children:[Object(v.jsxs)("p",{className:"gameName",children:[e.gameName," "]}),e.possibleMatches.map((function(e,t){return Object(v.jsxs)("li",{className:"possibleGameMatch",children:["!request ",e]})}))]})},J=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={validGames:[]},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(e){var t=this;I(G).then((function(e){return e.text()})).then((function(e){t.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{validGames:C.a.parse(e)})}))}))}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.validGames);return console.log(t),Object(v.jsx)("div",{className:"partyPackList",children:t.map((function(t,n){return Object(v.jsx)(A,{partyPackName:t,metadata:e.state.validGames[t]},n)}))})}}]),n}(a.Component),E=function(){var e="https://id.twitch.tv/oauth2/authorize?client_id=".concat("u172q64ekv1j8nxy1r48mb8vn4kk7v","&response_type=code&scope=chat:read chat:edit&redirect_uri=").concat("https://asukii314.github.io/twitch-request-wheel/%23");return Object(v.jsx)("a",{href:e,style:{backgroundColor:"rebeccapurple",borderRadius:"5px",padding:"10px",color:"white"},children:"Log In With Twitch"})},U=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(v.jsx)(r.b,{basename:"/",children:Object(v.jsx)("div",{className:"App",children:Object(v.jsxs)("header",{className:"App-header",children:[Object(v.jsx)(L.b,{exact:!0,path:"/login",children:E()}),Object(v.jsx)(L.b,{path:"/",component:F}),Object(v.jsx)(L.b,{path:"/gamelist",component:J})]})})})}}]),n}(a.Component),H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,84)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),s(e),c(e),i(e)}))};i.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(r.a,{children:Object(v.jsx)(U,{})})}),document.getElementById("root")),H()}},[[81,1,2]]]);
//# sourceMappingURL=main.3006d009.chunk.js.map