(this["webpackJsonptwitch-bot"]=this["webpackJsonptwitch-bot"]||[]).push([[0],{25:function(e,t){},39:function(e,t,n){},40:function(e,t,n){},44:function(e,t,n){},50:function(e,t){},72:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),c=n(27),i=n.n(c),r=n(15),o=(n(39),n(9)),l=n(10),u=n(12),h=n(11),d=(n(40),n(21)),p=n.n(d),j=n(3),b=n(28),m=n(32),g=n(33),f=n(16),x=n(29),O=n(34),y=(n(44),n.p+"static/media/lock.6857c469.svg"),v=n(1),k=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(o.a)(this,n),(s=t.call(this,e)).updateTimeDiff=function(){s.setState((function(){return Object(j.a)(Object(j.a)({},s.state),{},{timeDiff:"".concat(Math.floor((Date.now()-s.props.metadata.time)/6e4)," minutes ago")})}))},s.delete=function(e){s.props.onDelete(s.props.msg)},s.toggleLock=function(){s.props.toggleLock(s.props.msg)},s.state={timeDiff:0},s}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.metadata.locked?"1":"0.2";return Object(v.jsxs)("div",{children:[Object(v.jsx)(O.a,{effect:"solid",place:"right"}),Object(v.jsx)("div",{id:"baseDiv","data-tip":"Requested ".concat(this.state.timeDiff," by ").concat(this.props.metadata.username),style:{backgroundColor:"steelblue",textAlign:"left",borderRadius:"8px",textTransform:"capitalize"},onMouseEnter:this.updateTimeDiff,children:Object(v.jsxs)("p",{style:{margin:"0px 15px 7px",padding:"4px",fontSize:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[this.props.msg,Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)("img",{src:y,alt:"lock",style:{width:"16px",opacity:e,paddingRight:"8px"},className:"lock",onClick:this.toggleLock}),Object(v.jsx)("button",{type:"button",className:"deleteButton",onClick:this.delete,children:"X"})]})]})})]})}}]),n}(s.Component),w=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(o.a)(this,n),(s=t.call(this,e)).goForward=function(){s.state.index!==s.props.history.length-1&&s.setState((function(e){return Object(j.a)(Object(j.a)({},s.state),{},{index:s.state.index+1})}))},s.goBackward=function(){s.state.index<=0||s.setState((function(e){return Object(j.a)(Object(j.a)({},s.state),{},{index:s.state.index-1})}))},s.printGame=function(e){return e===s.state.index?Object(v.jsx)("b",{style:{color:"aquamarine"},children:s.props.history[e]}):s.props.history[e]},s.state={index:0},s}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{style:{marginLeft:"12px",width:"33%",textTransform:"capitalize"},children:[Object(v.jsx)("div",{style:{backgroundColor:"darkslategrey",borderRadius:"5px",marginTop:0,padding:"1px",marginBottom:"10px"},children:Object(v.jsxs)("p",{style:{fontSize:"14px",fontWeight:"700",height:"50px"},children:[" Up Next:",this.props.history.length>this.state.index&&Object(v.jsx)("p",{children:this.props.history[this.state.index]})]})}),Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(v.jsx)("button",{onClick:this.goBackward,style:{backgroundColor:"darkcyan",borderRadius:"5px",marginTop:0,width:"50%",marginBottom:"20px",marginRight:"5px"},children:" \ud83e\udca0 "}),Object(v.jsx)("button",{onClick:this.goForward,style:{backgroundColor:"darkcyan",borderRadius:"5px",marginTop:0,width:"50%",marginBottom:"20px",marginLeft:"5px"},children:" \ud83e\udca1 "})]}),Object(v.jsxs)("div",{style:{backgroundColor:"darkslategrey",borderRadius:"5px",marginTop:0,padding:"1px"},children:[Object(v.jsx)("p",{style:{fontSize:"14px",fontWeight:"700"},children:" History "}),Object(v.jsxs)("p",{style:{fontSize:"12px"},children:[this.props.history.map((function(t,n){return Object(v.jsx)("li",{children:e.printGame(n)},n)})),0===this.props.history.length&&Object(v.jsx)("li",{children:"No games yet"},"0")]})]})]})}}]),n}(s.Component),C=n(46),S=n(48),_="!request",q=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(o.a)(this,n),(s=t.call(this,e)).toggleLock=function(e){var t=Object(j.a)({},s.state.messages[e]);console.log(t),t.locked=!t.locked,s.setState((function(){return Object(j.a)(Object(j.a)({},s.state),{},{messages:Object(j.a)(Object(j.a)({},s.state.messages),{},Object(f.a)({},e,t))})}))},s.onGameChosen=function(e){0!==Object.keys(s.state.messages).length&&(s.state.messages[e].locked||setTimeout((function(){s.removeGame(e,!0)}),2500),s.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{history:[].concat(Object(g.a)(s.state.history),[e])})})))},s.removeGame=function(e){var t=Object(j.a)({},s.state.messages);delete t[e],s.setState((function(e){return Object(j.a)(Object(j.a)({},e),{},{messages:t,counter:s.state.counter+1})}))},s.onMessage=function(e,t,n,a){var c=function(e){if(e.startsWith(_))return e.replace(_,"").trim().toLowerCase()}(n);if(c)if(s.state.messages[c])s.sendMessage("/me @".concat(t.username,", ").concat(c," has already been requested!"));else{for(var i=null,r=0,o=Object.entries(s.state.messages);r<o.length;r++){var l=Object(m.a)(o[r],2),u=l[0];if(l[1].username===t.username){i=u;break}}s.setState((function(e){return Object(j.a)(Object(j.a)({},e),{},{messages:Object(j.a)(Object(j.a)({},s.state.messages),{},Object(f.a)({},c,{username:t.username,time:Date.now(),locked:!1})),counter:s.state.counter+1})})),i?s.props.channel===t.username?s.sendMessage("/me @".concat(t.username,", ").concat(c," has been added to the request queue. Your previous game request(s) weren't deleted, since you have special broadcaster privilege :P")):(s.removeGame(i),s.sendMessage("/me @".concat(t.username,", your previous request of ").concat(i," has been replaced with ").concat(c,"."))):s.sendMessage("/me @".concat(t.username,", ").concat(c," has been added to the request queue."))}},s.sendMessage=function(e){s.state.client.say(s.props.channel,e)},s.state={messages:{},colors:C({count:99,luminosity:"light",hue:"blue"}),counter:0,history:[]},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(e){var t=new S.client({identity:{username:this.props.channel,password:this.props.access_token},channels:[this.props.channel]});t.on("message",this.onMessage),t.connect(),console.log(JSON.stringify(t)),this.setState((function(e){return Object(j.a)(Object(j.a)({},e),{},{client:t})}))}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.messages);return console.log(this.state.history),Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsxs)("column",{width:"50vw",children:[Object(v.jsx)("h2",{style:{marginBottom:"0"},children:"Game Requests"}),Object(v.jsxs)("h4",{style:{fontSize:"20px",color:"yellow",marginTop:"6px",marginBottom:"12px",fontWeight:400},children:['Type e.g. "!request Blather Round" in ',this.props.channel,"'s chat to add"]}),Object(v.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",height:"100%"},children:[Object(v.jsx)(w,{history:this.state.history}),Object(v.jsx)("div",{style:{flexGrow:"2",marginLeft:"15px"},children:t.map((function(t,n){return Object(v.jsx)(k,{msg:t,metadata:e.state.messages[t],onDelete:e.removeGame,toggleLock:e.toggleLock.bind(t)},n)}))})]})]}),Object(v.jsx)("column",{width:"50vw",style:{textTransform:"capitalize"},children:Object(v.jsx)("div",{style:{fontSize:"16px",overflow:"hidden",width:"600px"},children:Object(v.jsx)(x.a,{segments:t,segColors:this.state.colors,onFinished:this.onGameChosen,isOnlyOnce:!1,size:250,upDuration:100,downDuration:1e3,primaryColor:"white",contrastColor:"black"},this.state.counter)})})]})}}]),n}(s.Component),D=n(4),T=n(30),L=n.n(T),z=n(66),B=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).state={username:"",access_token:"",failed_login:!1},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(b.a)(p.a.mark((function e(){var t,n=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=L.a.parse(this.props.location.search),e.next=3,z("https://id.twitch.tv/oauth2/token?"+new URLSearchParams({grant_type:"authorization_code",code:t.code,client_id:"u172q64ekv1j8nxy1r48mb8vn4kk7v",client_secret:"7yfmbc5ka6t7frki5g8m0qsboltp2p",redirect_uri:"https://asukii314.github.io/twitch-request-wheel/#"}),{method:"POST",headers:{Accept:"application/vnd.twitchtv.v5+json"}}).then((function(e){return e.json()})).then((function(e){e.access_token?(n.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{access_token:e.access_token})})),z("https://api.twitch.tv/helix/users",{headers:{"Client-ID":"u172q64ekv1j8nxy1r48mb8vn4kk7v",Authorization:"Bearer ".concat(e.access_token)}}).then((function(e){return e.json()})).then((function(e){n.setState((function(t){return Object(j.a)(Object(j.a)({},t),{},{username:e.data[0].login})}))}))):n.setState((function(e){return Object(j.a)(Object(j.a)({},e),{},{failed_login:!0})}))}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(v.jsx)("p",{children:this.state.failed_login?Object(v.jsx)(D.a,{to:"/login"}):this.state.username&&Object(v.jsx)(q,{channel:this.state.username,access_token:this.state.access_token})})}}]),n}(s.Component),M=Object(D.f)(B),R=function(){var e="https://id.twitch.tv/oauth2/authorize?client_id=".concat("u172q64ekv1j8nxy1r48mb8vn4kk7v","&response_type=code&scope=chat:read chat:edit&redirect_uri=").concat("https://asukii314.github.io/twitch-request-wheel/%23");return Object(v.jsx)("a",{href:e,style:{backgroundColor:"rebeccapurple",borderRadius:"5px",padding:"10px",color:"white"},children:"Log In With Twitch"})},G=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(v.jsx)(r.b,{basename:"/",children:Object(v.jsx)("div",{className:"App",children:Object(v.jsxs)("header",{className:"App-header",children:[Object(v.jsx)(D.b,{exact:!0,path:"/login",children:R()}),Object(v.jsx)(D.b,{path:"/",component:M})]})})})}}]),n}(s.Component),F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,74)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),s(e),a(e),c(e),i(e)}))};i.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(r.a,{children:Object(v.jsx)(G,{})})}),document.getElementById("root")),F()}},[[72,1,2]]]);
//# sourceMappingURL=main.9ccc0a8d.chunk.js.map