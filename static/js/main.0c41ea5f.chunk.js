(this["webpackJsonptwitch-bot"]=this["webpackJsonptwitch-bot"]||[]).push([[0],{104:function(e){e.exports=JSON.parse('{"a":"0.6.0"}')},188:function(e,t,a){},198:function(e,t){},212:function(e,t,a){},219:function(e,t,a){},220:function(e,t,a){},221:function(e,t,a){},222:function(e,t,a){},223:function(e,t,a){},224:function(e,t,a){},230:function(e,t,a){},231:function(e,t,a){},232:function(e,t,a){},233:function(e,t,a){},235:function(e,t,a){"use strict";a.r(t);var n=a(9),s=a(10),r=a(12),i=a(11),c=a(24),o=a.n(c),l=a(32),d=a(6),u=a(1),m=a.n(u),h=a(13),p=a(17),b=a(3),f=a(66),g=a.n(f),j=a(98),y=a(65),v=1,O=2,x=3,k=function(){function e(t){var a=this;Object(n.a)(this,e),this.updateLastMessageTime=function(e){a.lastMessageTimes=Object(b.a)(Object(b.a)({},a.lastMessageTimes),{},Object(p.a)({},e,Date.now()))},this.minsSinceLastChatMessage=function(e){return Math.floor((Date.now()-a.lastMessageTimes[e])/6e4)},this.getChatters=function(){return y("https://thingproxy.freeboard.io/fetch/https://tmi.twitch.tv/group/user/".concat(a.channel,"/chatters")).then((function(e){return e.json()})).then((function(e){return e&&e.chatters?[].concat(Object(h.a)(e.chatters.moderators),Object(h.a)(e.chatters.viewers),Object(h.a)(e.chatters.staff),Object(h.a)(e.chatters.admins),Object(h.a)(e.chatters.global_mods)):null})).catch((function(e){return null}))},this.channel=t,this.lastMessageTimes={},this.getStatusPromise=this.getStatusPromise.bind(this)}return Object(s.a)(e,[{key:"getStatusPromise",value:function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.channel){e.next=2;break}return e.abrupt("return",v);case 2:if(!(this.lastMessageTimes[t]&&this.minsSinceLastChatMessage(t)<10)){e.next=4;break}return e.abrupt("return",v);case 4:return e.abrupt("return",this.getChatters().then((function(e){return e&&e.includes(t)?O:x})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),P=(a(188),a(99)),N=a.p+"static/media/lock.6857c469.svg",S=a(2),w=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).deleteRequest=function(e){s.props.onDelete(s.props.gameName)},s.getFormattedTimeDiff=function(e){var t="minute",a=Math.floor((Date.now()-e)/6e4);return 0===a?"just now":(a>=60&&(t="hour",(a=Math.floor(a/60))>=24&&(t="day",a=Math.floor(a/24))),"".concat(a," ").concat(t).concat(1===a?"":"s"," ago"))},s.getTooltipContents=function(){var e="";switch(s.state.activityStatus){case v:e="active";break;case O:e="idle";break;case x:e="disconnected"}return'\n            <div class="tooltip">\n                <p class="tooltipText">\n                    Requested '.concat(s.state.timeDiff," by ").concat(s.props.metadata.username,'\n                </p>\n                <div class="status ').concat(e,'" />\n            </div>')},s.toggleLock=function(){s.props.toggleLock(s.props.gameName)},s.updateStatus=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.props.getActivity(s.props.metadata.username);case 3:return t=e.sent,e.abrupt("return",s.setState({timeDiff:s.getFormattedTimeDiff(s.props.metadata.time),activityStatus:t}));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),s.state={timeDiff:0,activityStatus:null},s.deleteRequest=s.deleteRequest.bind(Object(d.a)(s)),s.getFormattedTimeDiff=s.getFormattedTimeDiff.bind(Object(d.a)(s)),s.getTooltipContents=s.getTooltipContents.bind(Object(d.a)(s)),s.toggleLock=s.toggleLock.bind(Object(d.a)(s)),s.updateStatus=s.updateStatus.bind(Object(d.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.metadata.locked?"lock locked":"lock unlocked",t=this.props.metadata.chosen?"chosen":"pending";return Object(S.jsxs)("div",{className:"game-request-wrapper fade-in",children:[Object(S.jsx)(P.a,{effect:"solid",place:"left"}),Object(S.jsx)("div",{id:"baseDiv",className:"game-request ".concat(t),"data-tip":this.getTooltipContents(),"data-html":!0,onMouseEnter:this.updateStatus,children:Object(S.jsxs)("div",{className:"game-request-body",children:[this.props.gameName,Object(S.jsxs)("div",{className:"options",children:[Object(S.jsx)("img",{src:N,alt:"lock",className:e,onClick:this.toggleLock}),Object(S.jsx)("button",{type:"button",className:"deleteButton",onClick:this.deleteRequest,children:"X"})]})]})})]})}}]),a}(u.Component),G=a(8),M=a(45),C=a.p+"static/media/JackboxGames.97a3374d.yaml",q=a(67),R=a.n(q),I=a(65),T=a(196),L="!request",D=[{RequestName:"Affection",Response:"there there, it's going to be okay. VirtualHug",Variants:["a friend","a hug","a kiss","friend","hug","kiss","affection","a shoulder to cry on","shoulder to cry on"]},{RequestName:"Goose",Response:"please don't taunt the wheel. Honk.",Variants:["goose","honk","meow","mrow","woof","bark","nugs","chicken nugs"]},{RequestName:"Lewmon",Response:"please don't taunt the wheel. sirfar3Lewmon sirfar3Lewmon sirfar3Lewmon",Variants:["lewmon","sirfar3lewmon"]}],Q=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).componentDidMount=function(e){var t=s.getTwitchClient(s.props);return t.on("message",s.onMessage),t.connect(),s.getGameList(C,t)},s.getGameList=function(){var e=Object(l.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t).then((function(e){return e.text()})).then((function(e){return s.setState({client:a,validGames:R.a.parse(e)})})).catch((function(e){console.warn(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s.getTwitchClient=function(e){return new T.client({identity:{username:e.channel,password:e.access_token},channels:[e.channel]})},s.isModOrBroadcaster=function(e){return s.props.channel===e||s.props.modList.includes(e.toLowerCase())},s.checkForMiscCommands=function(e,t){if(e.startsWith("!gamelist")||e.startsWith("!gameslist"))return s.sendMessage("/me @".concat(t,", click here for a list of valid Jackbox games: ").concat("https://asukii314.github.io/twitch-request-wheel/#","/gamelist")),!0;if("!wheelcommands"===e)return s.sendMessage("/me @".concat(t,", click here to read about all supported commands: https://github.com/asukii314/twitch-request-wheel/blob/master/src/Commands.yaml")),!0;if(e.startsWith("!whichpack")){var a=e.replace("!whichpack","").trim();if(""===a)return s.sendMessage("/me @".concat(t,", please specify the game you would like to look up the party pack for: e.g. !whichpack TMP 2")),!0;var n=s.findGame(a,t);return n&&s.sendMessage("/me @".concat(t,", ").concat(n.name," is a ").concat(n.partyPack," game.")),!0}if("!advancenextgame"===e||"!nextgamefwd"===e||"!nextgameforward"===e)return s.isModOrBroadcaster(t)?(s.props.changeNextGameIdx(1)?s.props.upcomingGames.length>0?s.sendMessage("/me @".concat(t,", the next game has been changed to ").concat(s.props.upcomingGames[0].name,".")):s.sendMessage("/me @".concat(t,', the next game has been marked as "TBD".')):s.sendMessage("/me @".concat(t,", there are no more games in the queue to advance to!")),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0);if("!nextgameback"===e||"!nextgamebackward"===e)return s.isModOrBroadcaster(t)?(s.props.changeNextGameIdx(-1)?s.sendMessage("/me @".concat(t,", the next game has been changed to ").concat(s.props.upcomingGames[0].name,".")):s.sendMessage("/me @".concat(t,", there are no previous games in the queue to go back to!")),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0);if(e.startsWith("!setnextgame")||e.startsWith("!redeemgame")){if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use the ").concat(e.startsWith("!s")?"!setNextGame":"!redeemgame"," command.")),!0;var r=e.replace("!setnextgame","").replace("!redeemgame","").trim();if(""===r)return s.sendMessage("/me @".concat(t,", please specify the game you would like to insert in the queue: for example, ").concat(e.startsWith("!s")?"!setNextGame":"!redeemgame"," TMP 2")),!0;var i=s.findGame(r,t);if(i){var c=s.props.setNextGame(i);0===c?s.sendMessage("/me @".concat(t,", ").concat(i.name," has been inserted as the next game in the queue.")):s.sendMessage("/me @".concat(t,", ").concat(i.name," has been inserted in the queue following ").concat(c," other manual game request").concat(c>1?"s":"","."))}return!0}var o,l;if("!caniplay"===e||"!new"===e)return null===(o=s.props)||void 0===o||o.caniplayHandler(t,{sendConfirmationMsg:"!new"!==e}),!0;if(e.startsWith("!priorityseat")||e.startsWith("!redeemseat")){var d;if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0;var u=e.replace("!priorityseat","").replace("!redeemseat","").replace("@","").trim();return""===u?(s.sendMessage("/me @".concat(t,", please specify the user who has redeemed a priority seat in the next game: for example, ").concat(e.startsWith("!p")?"!priorityseat":"!redeemseat"," @asukii314")),!0):(null===(d=s.props)||void 0===d||d.caniplayHandler(u,{sendConfirmationMsg:!0,isPrioritySeat:!0}),!0)}if("!leave"===e||"!murd"===e)return null===(l=s.props)||void 0===l||l.playerExitHandler(t),!0;if("!clear"===e){var m;if(s.isModOrBroadcaster(t))null===(m=s.props)||void 0===m||m.clearQueueHandler();return!0}if("!open"===e){var h;if(s.isModOrBroadcaster(t))null===(h=s.props)||void 0===h||h.openQueueHandler();return!0}if("!close"===e){var p;if(s.isModOrBroadcaster(t))null===(p=s.props)||void 0===p||p.closeQueueHandler();return!0}return"!startgame"===e?s.isModOrBroadcaster(t)?(s.props.startGame()?s.sendMessage("/me @".concat(t,", the game has been started.")):s.sendMessage("/me @".concat(t,", the game was already started.")),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0):e.startsWith("!redeem")?(s.sendMessage("/me @".concat(t,", this command is no longer supported: please specify either !redeemgame or !redeemseat.")),!0):void 0},s.findGame=function(e,t){var a,n=Object(M.a)(D);try{for(n.s();!(a=n.n()).done;){var r,i=a.value;if(null===i||void 0===i||null===(r=i.Variants)||void 0===r?void 0:r.includes(e))return s.sendMessage("/me @".concat(t," ").concat(i.Response)),null}}catch(f){n.e(f)}finally{n.f()}for(var c in s.state.validGames)for(var o=s.state.validGames[c],l=0,d=Object.entries(o);l<d.length;l++){var u,m=Object(G.a)(d[l],2),h=m[0],p=m[1];if(null===p||void 0===p||null===(u=p.Variants)||void 0===u?void 0:u.includes(e))return Object(b.a)({name:h,longName:"".concat(h," (").concat(c,")"),partyPack:c},p)}s.sendMessage("/me @".concat(t,", ").concat(e," could not be found in the list of valid Jackbox games. Click here for a list of valid games: ").concat("https://asukii314.github.io/twitch-request-wheel/#","/gamelist"))},s.checkForGameCommand=function(e,t){if(e.startsWith(L)){var a=e.replace(L,"").trim();return""===a?(s.sendMessage("/me @".concat(t,", please specify the game you would like to request: for example, !request TMP 2")),null):s.findGame(a,t)}},s.onMessage=function(e,t,a,n){if(!n)if(s.props.onMessage(a,t.username,t),"!nextgame"!==a.trim()){var r=a.trim().toLowerCase();if(!s.checkForMiscCommands(r,t.username)){var i=s.checkForGameCommand(r,t.username);if(i)if(s.props.messages[i.longName])s.sendMessage("/me @".concat(t.username,", ").concat(i.name," has already been requested!"));else{for(var c=null,o=0,l=Object.values(s.props.messages);o<l.length;o++){var d=l[o];if(d.username===t.username){c=d.longName;break}}c?s.props.channel===t.username?s.sendMessage("/me @".concat(t.username,", ").concat(i.name," has been added to the request queue. Your previous game request(s) weren't deleted, since you have special broadcaster privilege :P")):(s.props.onDelete(c),s.sendMessage("/me @".concat(t.username,", your previous request of ").concat(c," has been replaced with ").concat(i.name,"."))):s.sendMessage("/me @".concat(t.username,", ").concat(i.name," has been added to the request queue.")),s.props.addGameRequest(i,t.username)}}}else if(s.props.upcomingGames&&s.props.upcomingGames.length>0){var u=s.props.upcomingGames[0].name;if(s.props.upcomingGames.length>1){u+=", followed by ".concat(s.props.upcomingGames[1].name);for(var m=2;m<s.props.upcomingGames.length;m++)u+=", and ".concat(s.props.upcomingGames[m].name)}s.sendMessage("/me @".concat(t.username,", the next game up is ").concat(u,"!"))}else s.sendMessage("/me @".concat(t.username,", the next game hasn't been decided yet - feel free to !request one :)"))},s.sendMessage=function(e){s.state.client.say(s.props.channel,e)},s.state={client:null,validGames:[]},s.getTwitchClient=s.getTwitchClient.bind(Object(d.a)(s)),s.isModOrBroadcaster=s.isModOrBroadcaster.bind(Object(d.a)(s)),s.checkForMiscCommands=s.checkForMiscCommands.bind(Object(d.a)(s)),s.findGame=s.findGame.bind(Object(d.a)(s)),s.checkForGameCommand=s.checkForGameCommand.bind(Object(d.a)(s)),s.onMessage=s.onMessage.bind(Object(d.a)(s)),s.sendMessage=s.sendMessage.bind(Object(d.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){return null}}]),a}(u.Component),_=a(38),F=(a(212),function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).getHistoryList=function(e){return 0===e.length?Object(S.jsx)("li",{children:"No games yet"},"placeholder"):Object(S.jsx)(_.c,{droppableId:"historyList",children:function(t){return Object(S.jsxs)("span",Object(b.a)(Object(b.a)({className:"historyList"},t.droppableProps),{},{ref:t.innerRef,children:[e.map((function(e,t){e.name;var a=e.time;return Object(S.jsx)(_.b,{draggableId:"".concat(a),index:t,children:function(e){return Object(S.jsx)("li",Object(b.a)(Object(b.a)(Object(b.a)({ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:s.printGame(t)}))}},"".concat(a))})),t.placeholder]}))}})},s.getNextGameName=function(){return s.hasNextGame()?s.props.history[s.props.nextGameIdx].name:"not yet decided"},s.getNextGamePartyPack=function(){return s.hasNextGame()?s.props.history[s.props.nextGameIdx].partyPack:null},s.handleOnDragEnd=function(e){if(e.destination){var t=Array.from(s.props.history).fill();t[s.props.nextGameIdx]=!0;var a=t.splice(e.source.index,1),n=Object(G.a)(a,1)[0];t.splice(e.destination.index,0,n);var r=t.findIndex((function(e){return e})),i=Array.from(s.props.history),c=i.splice(e.source.index,1),o=Object(G.a)(c,1)[0];i.splice(e.destination.index,0,o),s.props.changeGameOrder(i,r)}},s.hasNextGame=function(){return s.props.history.length>s.props.nextGameIdx},s.moveNextGameFwd=function(){return s.props.changeNextGameIdx(1)},s.moveNextGameBack=function(){return s.props.changeNextGameIdx(-1)},s.printGame=function(e){return e===s.props.nextGameIdx?Object(S.jsx)("b",{children:s.props.history[e].name}):s.props.history[e].name},s.state={index:0},s.getHistoryList=s.getHistoryList.bind(Object(d.a)(s)),s.getNextGameName=s.getNextGameName.bind(Object(d.a)(s)),s.getNextGamePartyPack=s.getNextGamePartyPack.bind(Object(d.a)(s)),s.hasNextGame=s.hasNextGame.bind(Object(d.a)(s)),s.moveNextGameBack=s.moveNextGameBack.bind(Object(d.a)(s)),s.moveNextGameFwd=s.moveNextGameFwd.bind(Object(d.a)(s)),s.printGame=s.printGame.bind(Object(d.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){var e,t=this.hasNextGame();switch(this.props.requestMode){case"game":e=Object(S.jsx)("button",{className:"open-seat-requests",disabled:!t,onClick:this.props.togglePlayerSelect,children:"OPEN SEAT REQUESTS"});break;case"seat":e=Object(S.jsx)("button",{className:"return-to-wheel",onClick:this.props.togglePlayerSelect,children:"RETURN TO WHEEL"})}return Object(S.jsxs)("div",{id:"sidebar",className:this.props.requestMode,children:[Object(S.jsx)("div",{className:"sidebar-panel",children:Object(S.jsxs)("div",{className:"p sidebar-panel-up-next",children:[" Up Next:",Object(S.jsx)("p",{className:"next-game-name",children:this.getNextGameName()}),Object(S.jsx)("p",{className:"next-game-party-pack",children:Object(S.jsx)("i",{children:this.getNextGamePartyPack()})}),e]})}),Object(S.jsxs)("div",{className:"nav-wrapper",children:[Object(S.jsx)("button",{className:"move-next-game-back",onClick:this.moveNextGameBack,children:" \u21e6 "}),Object(S.jsx)("button",{className:"move-next-game-fwd",onClick:this.moveNextGameFwd,children:" \u21e8 "})]}),Object(S.jsx)("div",{className:"sidebar-panel",children:Object(S.jsxs)(_.a,{onDragEnd:this.handleOnDragEnd,children:[Object(S.jsx)("p",{className:"sidebar-panel-history",children:" History "}),Object(S.jsx)("p",{className:"sidebar-panel-history-list",children:this.getHistoryList(this.props.history)})]})})]})}}]),a}(u.Component)),H={gameSelected:null,messages:{"Survive The Internet (Party Pack 4)":{name:"Survive The Internet",longName:"Survive The Internet (Party Pack 4)",partyPack:"Party Pack 4","Min players":3,"Max players":8,Variants:["survive","survive the internet","sti"],username:"dcpesses",time:1628112883959,locked:!1,chosen:!1},"Quiplash (Any Version)":{name:"Quiplash",longName:"Quiplash (Any Version)",partyPack:"Any Version","Min players":3,"Max players":8,Variants:["quiplash","quip","ql"],username:"dcpesses",time:1628113055677,locked:!1,chosen:!1},"You Don't Know Jack (Party Pack 5)":{name:"You Don't Know Jack",longName:"You Don't Know Jack (Party Pack 5)",partyPack:"Party Pack 5","Min players":1,"Max players":8,Variants:["ydkj 2","ydkj fs","ydkjfs","you dont know jack 2","you don't know jack 2","you don't know jack full stream","you don't know jack full steam","you don't know jack: full stream"],username:"dcpesses",time:1628114634007,locked:!1,chosen:!1},"Mad Verse City (Party Pack 5)":{name:"Mad Verse City",longName:"Mad Verse City (Party Pack 5)",partyPack:"Party Pack 5","Min players":3,"Max players":8,Variants:["mvc","madverse","mad verse","madversecity","mad verse city"],username:"dcpesses",time:1628114645263,locked:!1,chosen:!1},"Monster Seeking Monster (Party Pack 4)":{name:"Monster Seeking Monster",longName:"Monster Seeking Monster (Party Pack 4)",partyPack:"Party Pack 4","Min players":3,"Max players":7,Variants:["msm","monster seeking monster","monster seeking monsters","monsters seeking monsters"],username:"dcpesses",time:1628114646991,locked:!1,chosen:!1},"Blather 'Round (Party Pack 7)":{name:"Blather 'Round",longName:"Blather 'Round (Party Pack 7)",partyPack:"Party Pack 7","Min players":2,"Max players":6,Variants:["blather","blather round","blather 'round","blatherround","blatheround"],username:"dcpesses",time:1628114733155,locked:!1,chosen:!1},"Talking Points (Party Pack 7)":{name:"Talking Points",longName:"Talking Points (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["talking points","talkingpoints","talk points"],username:"dcpesses",time:1628114749438,locked:!1,chosen:!1},"Gartic Phone (Standalone)":{name:"Gartic Phone",longName:"Gartic Phone (Standalone)",partyPack:"Standalone","Min players":4,"Max players":30,Variants:["gartic phone","garticphone","garlic phone","garlicphone","gartic","garlic"],username:"dcpesses",time:1628114761558,locked:!1,chosen:!1},"Drawful (Any Version)":{name:"Drawful",longName:"Drawful (Any Version)",partyPack:"Any Version","Min players":3,"Max players":8,Variants:["drawful","drawfull","draw full"],username:"dcpesses",time:1628114769626,locked:!1,chosen:!1},"Words on Stream (Standalone)":{name:"Words on Stream",longName:"Words on Stream (Standalone)",partyPack:"Standalone","Min Players":4,"Max Players":50,Variants:["words on stream","word on stream","words stream","word stream","words","wos"],username:"dcpesses",time:1628114772430,locked:!1,chosen:!1},"Gartic on Stream (Standalone)":{name:"Gartic on Stream",longName:"Gartic on Stream (Standalone)",partyPack:"Standalone","Min Players":4,"Max Players":50,Variants:["gartic on stream","garlic on stream","garlic stream","gartic stream","gos"],username:"dcpesses",time:1628114776310,locked:!1,chosen:!1},"The Devils and the Details (Party Pack 7)":{name:"The Devils and the Details",longName:"The Devils and the Details (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["devils","devils in details","devils and details","devils & details","devil's in details","devil's and details","devil's & details","devils in the details","devils and the details","devils & the details","devil's in the details","devil's and the details","devil's & the details","the devils in the details","the devils and the details","the devils & the details","the devil's in the details","the devil's and the details","the devil's & the details"],username:"dcpesses",time:1628114937776,locked:!1,chosen:!1},"Fibbage: Enough About You (Party Pack 4)":{name:"Fibbage: Enough About You",longName:"Fibbage: Enough About You (Party Pack 4)",partyPack:"Party Pack 4","Min players":2,"Max players":8,Variants:["eay","enough about you","feay","fibbage eay","fibbage: eay","fibbage enough about you","fibbage: enough about you"],username:"dcpesses",time:1628114942915,locked:!1,chosen:!1},"Champ'd Up (Party Pack 7)":{name:"Champ'd Up",longName:"Champ'd Up (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["champd","champed","champd up","champ'd","champ'd up","champed up"],username:"dcpesses",time:1628114981572,locked:!1,chosen:!1},"Civic Doodle (Party Pack 4)":{name:"Civic Doodle",longName:"Civic Doodle (Party Pack 4)",partyPack:"Party Pack 4","Min players":3,"Max players":8,Variants:["civic doodle","civicdoodle","civic"],username:"dcpesses",time:1628115017116,locked:!1,chosen:!1},"Trivia Murder Party 2 (Party Pack 6)":{name:"Trivia Murder Party 2",longName:"Trivia Murder Party 2 (Party Pack 6)",partyPack:"Party Pack 6","Min players":1,"Max players":8,Variants:["tmp2","tmp 2","trivia murder party 2"],username:"dcpesses",time:1628118545790,locked:!1,chosen:!1},"Quiplash 3 (Party Pack 7)":{name:"Quiplash 3",longName:"Quiplash 3 (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["ql3","ql 3","quip 3","quip3","quiplash 3","quiplash3"],username:"dcpesses",time:1628121075780,locked:!1,chosen:!1},"Trivia Murder Party 1 (Party Pack 3)":{name:"Trivia Murder Party 1",longName:"Trivia Murder Party 1 (Party Pack 3)",partyPack:"Party Pack 3","Min players":1,"Max players":8,Variants:["tmp1","tmp 1","trivia murder party 1"],username:"dcpesses",time:1628122719930,locked:!1,chosen:!1}},colors:["#75a5e5","#847cef","#74aee0","#86efed","#63bbd8","#c9d8ff","#97ecef","#bcefff","#9caff4","#b9a4f2","#9fbbfc","#affffc","#a1bef4","#7ee7fc","#97c1ef","#a4a4fc","#a4a5f4","#b7f1ff","#79bdfc","#6885dd","#98e1f2","#aac1ff","#a583fc","#8991e5","#6edddd","#a7b7ef","#74e2e8","#9c9af9","#9dd5f2","#6a73ed","#b19df9","#88eaea","#6b91ef","#9de1f9","#7691fc","#d0c4fc","#c9d7ff","#84a7ed","#809bfc","#63d0d8","#b8cbfc","#a3a0ff","#b4f4f7","#9c9efc","#8ae8f7","#7985ea","#7876e8","#cfc2fc","#bfcfff","#92a9f4","#d0c2fc","#adc9f7","#767ce0","#95a1f9","#a286f4","#8085ed","#c4c9fc","#7c8ff9","#7079f9","#aaa5ff","#8db7e8","#9e94e8","#a5ffff","#76ade8","#a9f5fc","#a0a5ff","#9cbffc","#8fa2e8","#8eeeff","#88ccf7","#b0f2f4","#8e7fef","#aef9f8","#8beef9","#7a8ef4","#c7c4fc","#7b87f2","#7b77ea","#859be5","#7191e8","#aadaef","#b1aaf7","#80bff7","#95e0f4","#a3e5ed","#91a1f2","#c0c4f9","#7a90f4","#85def2","#87f2ee","#cac6ff","#76c3f7","#c2dcfc","#a2a2f9","#ccd7ff","#978fef","#8d77e5","#bad0fc","#ccf7ff"],counter:26,history:[{name:"Zeeple Dome",longName:"Zeeple Dome (Party Pack 5)",partyPack:"Party Pack 5","Min players":1,"Max players":6,Variants:["zeeple","zeeple dome","zeepledome"],username:"dcpesses",time:1628114757634,locked:!1,chosen:!1,override:!1},{name:"Split the Room",longName:"Split the Room (Party Pack 5)",partyPack:"Party Pack 5","Min players":3,"Max players":8,Variants:["split the room","splittheroom","split room","room split","split","str"],username:"dcpesses",time:1628114989864,locked:!1,chosen:!1,override:!1},{name:"Fibbage 3",longName:"Fibbage 3 (Party Pack 4)",partyPack:"Party Pack 4","Min players":2,"Max players":8,Variants:["fibbage 3","fibbage3"],username:"dcpesses",time:1628114666823,locked:!1,chosen:!1,override:!1},{name:"Trivia Murder Party",longName:"Trivia Murder Party (Any Version)",partyPack:"Any Version","Min players":1,"Max players":8,Variants:["tmp","trivia murder party"],username:"dcpesses",time:1628106145996,locked:!1,chosen:!1,override:!1}],nextGameIdx:0,showPlayerSelect:!1},W={interested:[{username:"player6",isPrioritySeat:!1},{username:"player3",isPrioritySeat:!1},{username:"player9"},{username:"dcpesses"}],playing:[{username:"player1",isPrioritySeat:!0},{username:"player7",isPrioritySeat:!1},{username:"player8"},{username:"player5",isPrioritySeat:!0},{username:"player2",isPrioritySeat:!0}],joined:[],streamerSeat:!0,isQueueOpen:!0,columnWidth:634},B=(a(219),a.p+"static/media/dice.021a7158.svg"),A=a.p+"static/media/star.de82f684.svg",V=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).updateColumnSizes=function(){s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{columnWidth:s.firstColumn.current.offsetWidth})}))},s.handleNewPlayerRequest=function(e,t){var a,n,r,i,c,o,l,d,u,m=t.isPrioritySeat,h=void 0!==m&&m;if(h){var p=s.state.isQueueOpen?"playing":"interested";return s.updateColumnForUser({username:e,isPrioritySeat:h},p)?"you have been successfully added to the lobby.":"there was an error adding you to the lobby."}return(null===(a=s.state)||void 0===a||null===(n=a.interested)||void 0===n||null===(r=n.map((function(e){return e.username})))||void 0===r?void 0:r.includes(e))||(null===(i=s.state)||void 0===i||null===(c=i.playing)||void 0===c||null===(o=c.map((function(e){return e.username})))||void 0===o?void 0:o.includes(e))||(null===(l=s.state)||void 0===l||null===(d=l.joined)||void 0===d||null===(u=d.map((function(e){return e.username})))||void 0===u?void 0:u.includes(e))?"you are already in the lobby.":s.state.isQueueOpen?s.updateColumnForUser({username:e},"interested")?"you have successfully joined the lobby.":"there was an error adding you to the lobby.":"the queue is currently closed; users have already been selected for this game."},s.updateColumnForUser=function(e,t){return!(!s.state||!s.state[t])&&(s.removeUser(e.username),s.setState((function(a){return Object(b.a)(Object(b.a)({},a),{},Object(p.a)({},t,[].concat(Object(h.a)(a[t]),[e])))})),!0)},s.removeUser=function(e){return s.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{interested:t.interested.filter((function(t){return t.username!==e})),playing:t.playing.filter((function(t){return t.username!==e})),joined:t.joined.filter((function(t){return t.username!==e}))})}))},s.clearQueue=function(){return s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{interested:[],playing:[],joined:[]})}))},s.openQueue=function(){return s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{isQueueOpen:!0})}))},s.closeQueue=function(){return s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{isQueueOpen:!1})}))},s.playerCount=function(){return s.state.playing.length+s.state.joined.length+(s.state.streamerSeat?1:0)},s.toggleStreamerSeat=function(){s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{streamerSeat:!e.streamerSeat})}))},s.canStartGame=function(){var e,t;return(null===(e=s.props.game)||void 0===e?void 0:e["Max players"])>=s.playerCount()&&(null===(t=s.props.game)||void 0===t?void 0:t["Min players"])<=s.playerCount()},s.startGame=function(){s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{interested:[],playing:[],joined:[]})})),s.props.startGame()},s.randomizePlayers=function(){for(var e,t,a=Math.min(s.props.game["Max players"]-s.playerCount(),s.state.interested.length),n=[],r=[],i=s.state.playing;n.length<a;)e=Math.floor(Math.random()*s.state.interested.length),n.includes(e)||(n.push(e),t=s.state.interested[e].username,r.push(t),i=[].concat(Object(h.a)(i),[s.state.interested[e]]));s.setState((function(e){return{interested:e.interested.filter((function(e){return!r.includes(e.username)})),playing:i}}))},s.renderPlayerCard=function(e,t,a){return Object(S.jsxs)("div",{className:"playerCard",children:[Object(S.jsxs)("div",{className:"playerCard-username",children:[!0===e.isPrioritySeat&&Object(S.jsx)("img",{src:A,alt:"Priority seat redemption"}),Object(S.jsx)("p",{className:"playerName",style:{maxWidth:s.state.columnWidth-25},children:e.username})]}),Object(S.jsxs)("div",{className:"changeColButtonsContainer",children:["interested"!==a&&Object(S.jsx)("button",{className:"changeCol",onClick:s.updateColumnForUser.bind(Object(d.a)(s),e,"interested"),children:"Interested"}),"playing"!==a&&Object(S.jsx)("button",{className:"changeCol",onClick:s.updateColumnForUser.bind(Object(d.a)(s),e,"playing"),children:"Playing"}),Object(S.jsx)("button",{className:"changeCol",onClick:s.removeUser.bind(Object(d.a)(s),e.username),children:"X"})]})]},t)},s.renderStreamerSeatToggle=function(){return Object(S.jsxs)("div",{className:"my-toggle-group",children:[Object(S.jsx)("p",{className:"toggle-label",children:"Reserve seat for streamer?"}),Object(S.jsxs)("div",{className:"my-toggle",children:[Object(S.jsx)("input",{type:"checkbox",defaultChecked:!0,onChange:s.toggleStreamerSeat}),Object(S.jsx)("div",{className:"my-toggle-text no","aria-hidden":"true",children:"No"}),Object(S.jsx)("div",{className:"my-toggle-text yes","aria-hidden":"true",children:"Yes"}),Object(S.jsx)("div",{className:"my-toggle-orb"})]})]})},s.renderPlayerCount=function(){var e,t,a="playerCount";return(null===(e=s.props.game)||void 0===e?void 0:e["Max players"])<s.playerCount()&&(a+=" overlimit"),Object(S.jsxs)("p",{className:a,children:[s.playerCount()," of ",null===(t=s.props.game)||void 0===t?void 0:t["Max players"]," seats claimed"]})},s.firstColumn=m.a.createRef(),s.state={interested:[],playing:[],joined:[],streamerSeat:!1,isQueueOpen:!0},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){-1!==window.location.hash.indexOf("fakestate=true")&&this.setState(W),this.updateColumnSizes(),window.addEventListener("resize",this.updateColumnSizes)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateColumnSizes)}},{key:"render",value:function(){var e,t,a,n=this,s="startGame";return this.playerCount()<(null===(e=this.props.game)||void 0===e?void 0:e["Min players"])&&(s+=" disabled"),Object(S.jsxs)("div",{className:"playerSelectContainer",children:[Object(S.jsxs)("div",{className:"header",children:[this.renderStreamerSeatToggle(),Object(S.jsxs)("div",{className:"game-name",children:[Object(S.jsx)("b",{children:null!==(t=null===(a=this.props.game)||void 0===a?void 0:a.name)&&void 0!==t?t:"TBD"}),this.renderPlayerCount()]}),Object(S.jsx)("button",{className:s,onClick:this.startGame,disabled:!this.canStartGame(),children:"Start Game"})]}),Object(S.jsxs)("div",{className:"playerCardContainer",children:[Object(S.jsxs)("div",{ref:this.firstColumn,className:"playerCardColumn interested",children:[Object(S.jsx)("p",{className:"playerCardColumn-header",children:"Interested"}),this.state.interested.filter((function(e){return e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"interested")})),this.state.interested.filter((function(e){return!e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"interested")}))]}),Object(S.jsxs)("div",{className:"playerCardColumn playing",children:[Object(S.jsxs)("p",{className:"playerCardColumn-header",children:["Playing",Object(S.jsx)("button",{className:"dice",onClick:this.randomizePlayers,children:Object(S.jsx)("img",{src:B,alt:"dice icon"})})]}),this.state.playing.filter((function(e){return e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"playing")})),this.state.playing.filter((function(e){return!e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"playing")}))]})]})]})}}]),a}(u.Component),E=(a(220),a(97)),U=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).changeNextGameIdx=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return!(s.state.nextGameIdx+e>s.state.history.length)&&(!(s.state.nextGameIdx+e<0)&&(s.setState((function(t){return{nextGameIdx:t.nextGameIdx+e}})),!0))},s.changeGameOrder=function(e,t){return!(t>e.length)&&(s.setState({history:e,nextGameIdx:t}),!0)},s.moveNextGameFwd=function(){return s.changeNextGameIdx()},s.moveNextGameBack=function(){return s.changeNextGameIdx(-1)},s.addGameRequest=function(e,t){s.setState((function(a){return Object(b.a)(Object(b.a)({},a),{},{messages:Object(b.a)(Object(b.a)({},s.state.messages),{},Object(p.a)({},e.longName,Object(b.a)(Object(b.a)({},e),{},{username:t,time:Date.now(),locked:!1,chosen:!1}))),counter:s.state.counter+1})}))},s.toggleLock=function(e){var t=Object(b.a)({},s.state.messages[e]);t.locked=!t.locked,s.setState((function(){return Object(b.a)(Object(b.a)({},s.state),{},{messages:Object(b.a)(Object(b.a)({},s.state.messages),{},Object(p.a)({},e,t))})}))},s.setNextGame=function(e){for(var t=s.state.nextGameIdx;t<s.state.history.length&&(null===(a=s.state.history[t])||void 0===a?void 0:a.override);){var a;t++}return s.setState((function(a){return Object(b.a)(Object(b.a)({},a),{},{history:[].concat(Object(h.a)(a.history.slice(0,Math.max(0,t))),[Object(b.a)(Object(b.a)({},e),{},{override:!0,time:Date.now()})],Object(h.a)(a.history.slice(t)))})})),t-s.state.nextGameIdx},s.addGameToQueue=function(e){s.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{gameSelected:e,history:[].concat(Object(h.a)(s.state.history),[Object(b.a)(Object(b.a)({},e),{},{override:!1})]),messages:Object(b.a)(Object(b.a)({},t.messages),{},Object(p.a)({},e.longName,Object(b.a)(Object(b.a)({},t.messages[e.longName]),{},{chosen:!0})))})}))},s.clearModal=function(){s.setState({gameSelected:null})},s.onWheelSpun=function(e){var t,a=null===(t=s.state.messages)||void 0===t?void 0:t[e];if(a){var n=a.username;return s.addGameToQueue(a),s.state.messages[e].locked||setTimeout((function(){s.removeGame(e),s.clearModal()}),4e3),s.chatActivity.getStatusPromise(n).then((function(e){var t="";switch(e){case x:t="/me ".concat(a.name," just won the spin, but it doesn't seem like @").concat(n," is still around. Hope someone else wants to play!");break;case v:t="/me @".concat(n,", good news - ").concat(a.name," just won the spin!");break;case O:default:t="/me @".concat(n,", good news - ").concat(a.name," just won the spin! (I hope you're still around!)")}return s.messageHandler.sendMessage(t)}))}},s.removeGame=function(e){var t=Object(b.a)({},s.state.messages);delete t[e],s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{messages:t,counter:s.state.counter+1})}))},s.onMessage=function(e,t,a){s.chatActivity.updateLastMessageTime(t)},s.togglePlayerSelect=function(){s.setState((function(e){return{showPlayerSelect:!e.showPlayerSelect}}))},s.routePlayRequest=function(e,t){var a,n,r=t.sendConfirmationMsg,i=void 0===r||r,c=t.isPrioritySeat,o=void 0!==c&&c,l=s.state.showPlayerSelect?null===(a=s.playerSelector)||void 0===a?void 0:a.handleNewPlayerRequest(e,{isPrioritySeat:o}):"sign-ups are currently closed; try again after this game wraps up!";i&&(null===(n=s.messageHandler)||void 0===n||n.sendMessage("/me @".concat(e,", ").concat(l)))},s.routeLeaveRequest=function(e){var t;null===(t=s.playerSelector)||void 0===t||t.removeUser(e)},s.routeOpenQueueRequest=function(){var e;s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{showPlayerSelect:!0})})),null===(e=s.playerSelector)||void 0===e||e.openQueue()},s.routeCloseQueueRequest=function(){var e;null===(e=s.playerSelector)||void 0===e||e.closeQueue()},s.routeClearQueueRequest=function(){var e;null===(e=s.playerSelector)||void 0===e||e.clearQueue()},s.startGame=function(){return!!s.state.showPlayerSelect&&(s.togglePlayerSelect(),s.moveNextGameFwd(),!0)},s.setMessageHandlerRef=function(e){s.messageHandler=e},s.setPlayerSelectRef=function(e){s.playerSelector=e},s.chatActivity=new k(s.props.channel),s.state={gameSelected:null,messages:{},colors:E({count:99,luminosity:"light",hue:"blue"}),counter:0,history:[],nextGameIdx:0,showPlayerSelect:!1},s.playerSelector=null,s.messageHandler=null,s.changeNextGameIdx=s.changeNextGameIdx.bind(Object(d.a)(s)),s.moveNextGameFwd=s.moveNextGameFwd.bind(Object(d.a)(s)),s.moveNextGameBack=s.moveNextGameBack.bind(Object(d.a)(s)),s.addGameRequest=s.addGameRequest.bind(Object(d.a)(s)),s.toggleLock=s.toggleLock.bind(Object(d.a)(s)),s.setNextGame=s.setNextGame.bind(Object(d.a)(s)),s.addGameToQueue=s.addGameToQueue.bind(Object(d.a)(s)),s.onWheelSpun=s.onWheelSpun.bind(Object(d.a)(s)),s.removeGame=s.removeGame.bind(Object(d.a)(s)),s.onMessage=s.onMessage.bind(Object(d.a)(s)),s.togglePlayerSelect=s.togglePlayerSelect.bind(Object(d.a)(s)),s.routePlayRequest=s.routePlayRequest.bind(Object(d.a)(s)),s.routeLeaveRequest=s.routeLeaveRequest.bind(Object(d.a)(s)),s.routeOpenQueueRequest=s.routeOpenQueueRequest.bind(Object(d.a)(s)),s.routeCloseQueueRequest=s.routeCloseQueueRequest.bind(Object(d.a)(s)),s.routeClearQueueRequest=s.routeClearQueueRequest.bind(Object(d.a)(s)),s.startGame=s.startGame.bind(Object(d.a)(s)),s.setMessageHandlerRef=s.setMessageHandlerRef.bind(Object(d.a)(s)),s.setPlayerSelectRef=s.setPlayerSelectRef.bind(Object(d.a)(s)),s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){-1!==window.location.hash.indexOf("fakestate=true")&&(-1!==window.location.hash.indexOf("playerselect=true")?this.setState(Object.assign({},H,{showPlayerSelect:!0})):this.setState(H))}},{key:"renderGameChosenModal",value:function(e){var t,a=this,n={force:.6,duration:3500,particleCount:100,floorHeight:Math.max(window.outerWidth,window.outerHeight),floorWidth:Math.max(window.outerWidth,window.outerHeight)};return e.username&&(t=Object(S.jsxs)("h4",{children:["requested by @",e.username]})),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"overlay fade-in-out",children:Object(S.jsx)("div",{className:"confetti-wrapper",children:Object(S.jsx)(g.a,Object(b.a)({},n))})}),Object(S.jsxs)("div",{className:"modal fade-in-out",onClick:function(){return a.removeGame(e.longName)},children:[Object(S.jsx)("h1",{children:e.name}),t]})]})}},{key:"render",value:function(){var e,t,a=this,n=Object.keys(this.state.messages);this.state.gameSelected&&(e=this.renderGameChosenModal(this.state.gameSelected)),"function"===typeof this.props.onLogout&&(t=Object(S.jsx)("button",{className:"logout",onClick:this.props.onLogout,children:"Logout \u27a7"}));var s,r,i,c=this.state.showPlayerSelect?"player-select":"game-select",o=this.state.showPlayerSelect?Object(S.jsxs)("span",{className:"subheading-player fade-in-delay",children:["Type ",Object(S.jsx)("b",{children:"!new"})," in ",this.props.channel,"'s chat if you want to join the next game"]}):Object(S.jsxs)("span",{className:"subheading-game fade-in-delay",children:["Type e.g. ",Object(S.jsx)("b",{children:'"!request Blather Round"'})," in ",this.props.channel,"'s chat to add"]});this.state.showPlayerSelect?s=Object(S.jsx)(V,{game:null===(i=this.state.history)||void 0===i?void 0:i[this.state.nextGameIdx],startGame:this.startGame,ref:this.setPlayerSelectRef}):(s=n.map((function(e,t){return Object(S.jsx)(w,{gameName:e,metadata:a.state.messages[e],onDelete:a.removeGame,toggleLock:a.toggleLock.bind(e),getActivity:a.chatActivity.getStatusPromise},t)})),r=Object(S.jsx)("div",{className:"right-column",width:"50px",children:Object(S.jsx)("div",{className:"wheel-wrapper fade-in",children:Object(S.jsx)(j.a,{segments:n,segColors:this.state.colors,onFinished:this.onWheelSpun,isOnlyOnce:!1,size:250,upDuration:100,downDuration:1e3,primaryColor:"white",contrastColor:"black",fontFamily:"Arial",multilineDelimiter:" ("},this.state.counter)})}));return Object(S.jsxs)("div",{id:"main-screen",className:c,children:[Object(S.jsx)(Q,{addGameRequest:this.addGameRequest,setNextGame:this.setNextGame,changeNextGameIdx:this.changeNextGameIdx,startGame:this.startGame,messages:this.state.messages,channel:this.props.channel,modList:this.props.modList,access_token:this.props.access_token,onMessage:this.onMessage,onDelete:this.removeGame,upcomingGames:this.state.history.slice(this.state.nextGameIdx),caniplayHandler:this.routePlayRequest,playerExitHandler:this.routeLeaveRequest,openQueueHandler:this.routeOpenQueueRequest,closeQueueHandler:this.routeCloseQueueRequest,clearQueueHandler:this.routeClearQueueRequest,ref:this.setMessageHandlerRef}),Object(S.jsxs)("div",{className:"left-column fade-in",children:[Object(S.jsx)("h2",{children:this.state.showPlayerSelect?"Seat Requests":"Game Requests"}),Object(S.jsx)("h4",{children:o}),Object(S.jsxs)("div",{className:"left-column-body",children:[Object(S.jsx)(F,{changeGameOrder:this.changeGameOrder,history:this.state.history,nextGameIdx:this.state.nextGameIdx,changeNextGameIdx:this.changeNextGameIdx,moveNextGameFwd:this.moveNextGameFwd,moveNextGameBack:this.moveNextGameBack,togglePlayerSelect:this.togglePlayerSelect,requestMode:this.state.showPlayerSelect?"seat":"game"}),Object(S.jsx)("div",{className:"left-column-inner-body",children:s})]})]}),r,t,e]})}}]),a}(u.Component),z=a(251),J=a(252),Y=a(249),X=a(250),K=a.p+"static/media/lock.6857c469.svg",Z=(a(221),function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).deleteRequest=function(e){s.props.onDelete(s.props.gameName)},s.getFormattedTimeDiff=function(e){var t="minute",a=Math.floor((Date.now()-e)/6e4);return 0===a?"just now":(a>=60&&(t="hour",(a=Math.floor(a/60))>=24&&(t="day",a=Math.floor(a/24))),"".concat(a," ").concat(t).concat(1===a?"":"s"," ago"))},s.getTooltipContents=function(){var e="";switch(s.state.activityStatus){case v:e="active";break;case O:e="idle";break;case x:e="disconnected"}return Object(S.jsxs)("div",{className:"tooltip",children:[Object(S.jsxs)("p",{className:"tooltipText",children:["Requested ",s.state.timeDiff," by ",s.props.metadata.username]}),Object(S.jsx)("div",{className:"status ".concat(e)})]})},s.toggleLock=function(){s.props.toggleLock(s.props.gameName)},s.updateStatus=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.props.getActivity(s.props.metadata.username);case 3:return t=e.sent,e.abrupt("return",s.setState({timeDiff:s.getFormattedTimeDiff(s.props.metadata.time),activityStatus:t}));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),s.state={timeDiff:0,activityStatus:null},s.deleteRequest=s.deleteRequest.bind(Object(d.a)(s)),s.getFormattedTimeDiff=s.getFormattedTimeDiff.bind(Object(d.a)(s)),s.getTooltipContents=s.getTooltipContents.bind(Object(d.a)(s)),s.toggleLock=s.toggleLock.bind(Object(d.a)(s)),s.updateStatus=s.updateStatus.bind(Object(d.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.metadata.locked?"lock locked":"lock unlocked",a=this.props.metadata.chosen?"chosen":"pending";return Object(S.jsx)(X.a,{placement:"left",overlay:function(t){return Object(S.jsx)(Y.a,Object(b.a)(Object(b.a)({id:"game-request-tooltip"},t),{},{children:Object(S.jsxs)("span",{className:"tooltipText",children:["Requested ",e.state.timeDiff," by ",e.props.metadata.username]})}))},onEnter:this.updateStatus,children:Object(S.jsx)("div",{className:"game-request-wrapper fade-in",children:Object(S.jsx)("div",{id:"baseDiv",className:"game-request ".concat(a),children:Object(S.jsxs)("div",{className:"game-request-body",children:[this.props.gameName,Object(S.jsxs)("div",{className:"options",children:[Object(S.jsx)("img",{src:K,alt:"lock",className:t,onClick:this.toggleLock}),Object(S.jsx)("button",{type:"button",className:"deleteButton",onClick:this.deleteRequest,children:"X"})]})]})})})})}}]),a}(u.Component)),$=a.p+"static/media/dice.021a7158.svg",ee=a.p+"static/media/star.de82f684.svg",te=(a(222),function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).updateColumnSizes=function(){s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{columnWidth:s.firstColumn.current.offsetWidth})}))},s.handleNewPlayerRequest=function(e,t){var a,n,r,i,c,o,l,d,u,m=t.isPrioritySeat,h=void 0!==m&&m;if(h){var p=s.state.isQueueOpen?"playing":"interested";return s.updateColumnForUser({username:e,isPrioritySeat:h},p)?"you have been successfully added to the lobby.":"there was an error adding you to the lobby."}return(null===(a=s.state)||void 0===a||null===(n=a.interested)||void 0===n||null===(r=n.map((function(e){return e.username})))||void 0===r?void 0:r.includes(e))||(null===(i=s.state)||void 0===i||null===(c=i.playing)||void 0===c||null===(o=c.map((function(e){return e.username})))||void 0===o?void 0:o.includes(e))||(null===(l=s.state)||void 0===l||null===(d=l.joined)||void 0===d||null===(u=d.map((function(e){return e.username})))||void 0===u?void 0:u.includes(e))?"you are already in the lobby.":s.state.isQueueOpen?s.updateColumnForUser({username:e},"interested")?"you have successfully joined the lobby.":"there was an error adding you to the lobby.":"the queue is currently closed; users have already been selected for this game."},s.updateColumnForUser=function(e,t){return!(!s.state||!s.state[t])&&(s.removeUser(e.username),s.setState((function(a){return Object(b.a)(Object(b.a)({},a),{},Object(p.a)({},t,[].concat(Object(h.a)(a[t]),[e])))})),!0)},s.removeUser=function(e){return s.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{interested:t.interested.filter((function(t){return t.username!==e})),playing:t.playing.filter((function(t){return t.username!==e})),joined:t.joined.filter((function(t){return t.username!==e}))})}))},s.clearQueue=function(){return s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{interested:[],playing:[],joined:[]})}))},s.openQueue=function(){return s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{isQueueOpen:!0})}))},s.closeQueue=function(){return s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{isQueueOpen:!1})}))},s.playerCount=function(){return s.state.playing.length+s.state.joined.length+(s.state.streamerSeat?1:0)},s.toggleStreamerSeat=function(){s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{streamerSeat:!e.streamerSeat})}))},s.canStartGame=function(){var e,t;return(null===(e=s.props.game)||void 0===e?void 0:e["Max players"])>=s.playerCount()&&(null===(t=s.props.game)||void 0===t?void 0:t["Min players"])<=s.playerCount()},s.startGame=function(){s.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{interested:[],playing:[],joined:[]})})),s.props.startGame()},s.randomizePlayers=function(){for(var e,t,a=Math.min(s.props.game["Max players"]-s.playerCount(),s.state.interested.length),n=[],r=[],i=s.state.playing;n.length<a;)e=Math.floor(Math.random()*s.state.interested.length),n.includes(e)||(n.push(e),t=s.state.interested[e].username,r.push(t),i=[].concat(Object(h.a)(i),[s.state.interested[e]]));s.setState((function(e){return{interested:e.interested.filter((function(e){return!r.includes(e.username)})),playing:i}}))},s.renderPlayerCard=function(e,t,a){return Object(S.jsxs)("div",{className:"player-card lh-sm fs-6",children:[Object(S.jsxs)("div",{className:"player-card-username",children:[!0===e.isPrioritySeat&&Object(S.jsx)("img",{src:ee,alt:"Priority seat redemption"}),Object(S.jsx)("p",{className:"player-name",style:{maxWidth:s.state.columnWidth-25},children:e.username})]}),Object(S.jsxs)("div",{className:"change-col-buttons-container",children:["interested"!==a&&Object(S.jsx)("button",{className:"change-col",onClick:s.updateColumnForUser.bind(Object(d.a)(s),e,"interested"),children:"Interested"}),"playing"!==a&&Object(S.jsx)("button",{className:"change-col",onClick:s.updateColumnForUser.bind(Object(d.a)(s),e,"playing"),children:"Playing"}),Object(S.jsx)("button",{className:"change-col",onClick:s.removeUser.bind(Object(d.a)(s),e.username),children:"X"})]})]},t)},s.renderStreamerSeatToggle=function(){return Object(S.jsxs)("div",{className:"toggle-streamer-seat",children:[Object(S.jsx)("label",{className:"toggle-label form-check-label",for:"reserve-seat-for-streamer",children:"Reserve seat for streamer?"}),Object(S.jsx)("div",{className:"form-check form-switch",children:Object(S.jsx)("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"reserve-seat-for-streamer",defaultChecked:!0,onChange:s.toggleStreamerSeat})})]})},s.renderPlayerCount=function(){var e,t,a="player-count";return(null===(e=s.props.game)||void 0===e?void 0:e["Max players"])<s.playerCount()&&(a+=" overlimit"),Object(S.jsxs)("div",{className:a,children:[s.playerCount()," of ",null===(t=s.props.game)||void 0===t?void 0:t["Max players"]," seats claimed"]})},s.firstColumn=m.a.createRef(),s.state={interested:[],playing:[],joined:[],streamerSeat:!1,isQueueOpen:!0},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){-1!==window.location.hash.indexOf("fakestate=true")&&this.setState(W),this.updateColumnSizes(),window.addEventListener("resize",this.updateColumnSizes)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateColumnSizes)}},{key:"render",value:function(){var e,t,a,n=this,s="btn btn-sm start-game";return this.playerCount()<(null===(e=this.props.game)||void 0===e?void 0:e["Min players"])&&(s+=" disabled"),Object(S.jsxs)("div",{className:"card player-select-container",children:[Object(S.jsxs)("div",{className:"card-header d-flex justify-content-between",children:[this.renderStreamerSeatToggle(),Object(S.jsxs)("div",{className:"fs-2 lh-sm game-name",children:[Object(S.jsx)("b",{children:null!==(t=null===(a=this.props.game)||void 0===a?void 0:a.name)&&void 0!==t?t:"TBD"}),this.renderPlayerCount()]}),Object(S.jsx)("button",{className:s,onClick:this.startGame,disabled:!this.canStartGame(),children:"Start Game"})]}),Object(S.jsxs)("div",{className:"card-body player-card-container",children:[Object(S.jsxs)("div",{ref:this.firstColumn,className:"player-card-column interested",children:[Object(S.jsx)("p",{className:"player-card-column-header",children:"Interested"}),this.state.interested.filter((function(e){return e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"interested")})),this.state.interested.filter((function(e){return!e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"interested")}))]}),Object(S.jsxs)("div",{className:"player-card-column playing",children:[Object(S.jsxs)("p",{className:"player-card-column-header",children:["Playing",Object(S.jsx)("button",{className:"dice",onClick:this.randomizePlayers,children:Object(S.jsx)("img",{src:$,alt:"dice icon"})})]}),this.state.playing.filter((function(e){return e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"playing")})),this.state.playing.filter((function(e){return!e.isPrioritySeat})).map((function(e,t){return n.renderPlayerCard(e,t,"playing")}))]})]})]})}}]),a}(u.Component)),ae=(a(223),function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).getHistoryList=function(e){return 0===e.length?Object(S.jsx)("span",{className:"history-placeholder",children:"No games yet"},"placeholder"):Object(S.jsx)(_.c,{droppableId:"historyList",children:function(t){return Object(S.jsxs)("span",Object(b.a)(Object(b.a)({className:"historyList"},t.droppableProps),{},{ref:t.innerRef,children:[e.map((function(e,t){e.name;var a=e.time;return Object(S.jsx)(_.b,{draggableId:"".concat(a),index:t,children:function(e){return Object(S.jsx)("li",Object(b.a)(Object(b.a)(Object(b.a)({ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:s.printGame(t)}))}},"".concat(a))})),t.placeholder]}))}})},s.getNextGameName=function(){return s.hasNextGame()?s.props.history[s.props.nextGameIdx].name:"not yet decided"},s.getNextGamePartyPack=function(){return s.hasNextGame()?s.props.history[s.props.nextGameIdx].partyPack:null},s.handleOnDragEnd=function(e){if(e.destination){var t=Array.from(s.props.history).fill();t[s.props.nextGameIdx]=!0;var a=t.splice(e.source.index,1),n=Object(G.a)(a,1)[0];t.splice(e.destination.index,0,n);var r=t.findIndex((function(e){return e})),i=Array.from(s.props.history),c=i.splice(e.source.index,1),o=Object(G.a)(c,1)[0];i.splice(e.destination.index,0,o),s.props.changeGameOrder(i,r)}},s.hasNextGame=function(){return s.props.history.length>s.props.nextGameIdx},s.moveNextGameFwd=function(){return s.props.changeNextGameIdx(1)},s.moveNextGameBack=function(){return s.props.changeNextGameIdx(-1)},s.printGame=function(e){return e===s.props.nextGameIdx?Object(S.jsx)("b",{children:s.props.history[e].name}):s.props.history[e].name},s.state={index:0},s.getHistoryList=s.getHistoryList.bind(Object(d.a)(s)),s.getNextGameName=s.getNextGameName.bind(Object(d.a)(s)),s.getNextGamePartyPack=s.getNextGamePartyPack.bind(Object(d.a)(s)),s.hasNextGame=s.hasNextGame.bind(Object(d.a)(s)),s.moveNextGameBack=s.moveNextGameBack.bind(Object(d.a)(s)),s.moveNextGameFwd=s.moveNextGameFwd.bind(Object(d.a)(s)),s.printGame=s.printGame.bind(Object(d.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){var e,t=this.hasNextGame();switch(this.props.requestMode){case"game":e=Object(S.jsx)("button",{id:"sidebar-up-next",className:"open-seat-requests",disabled:!t,onClick:this.props.togglePlayerSelect,children:"OPEN SEAT REQUESTS"});break;case"seat":e=Object(S.jsx)("button",{id:"sidebar-up-next",className:"return-to-wheel",onClick:this.props.togglePlayerSelect,children:"RETURN TO WHEEL"})}return Object(S.jsxs)("div",{id:"sidebar",className:this.props.requestMode,children:[Object(S.jsxs)("div",{className:"card sidebar-panel",children:[Object(S.jsx)("div",{className:"card-header fw-bolder",children:"Up Next"}),Object(S.jsxs)("div",{className:"card-body sidebar-up-next-panel",children:[Object(S.jsx)("h6",{className:"card-title mb-2 fw-bolder",children:this.getNextGameName()}),Object(S.jsx)("div",{className:"card-subtitle mb-2 fs-7 fst-italic text-light",style:{"--bs-text-opacity":"0.75"},children:this.getNextGamePartyPack()}),e]})]}),Object(S.jsxs)("div",{className:"nav-wrapper",children:[Object(S.jsx)("button",{className:"btn-sm move-next-game-back",onClick:this.moveNextGameBack,children:" \u21e6 "}),Object(S.jsx)("button",{className:"btn-sm move-next-game-fwd",onClick:this.moveNextGameFwd,children:" \u21e8 "})]}),Object(S.jsx)("div",{className:"card sidebar-panel",children:Object(S.jsxs)(_.a,{onDragEnd:this.handleOnDragEnd,children:[Object(S.jsx)("div",{className:"card-header fw-bolder",children:"History"}),Object(S.jsx)("div",{className:"card-body sidebar-history-list-panel",children:this.getHistoryList(this.props.history)})]})})]})}}]),a}(u.Component)),ne=function(e){var t=e.segments,a=e.segColors,n=e.winningSegment,s=e.onStart,r=void 0===s?function(){}:s,i=e.onSpinProgress,c=e.onFinished,o=e.primaryColor,l=e.contrastColor,d=e.buttonText,m=e.isOnlyOnce,h=void 0===m||m,p=e.size,b=void 0===p?290:p,f=e.upDuration,g=void 0===f?100:f,j=e.downDuration,y=void 0===j?1e3:j,v=e.fontFamily,O=void 0===v?"proxima-nova":v,x=e.wheelHeight,k=void 0===x?720:x,P=e.wheelWidth,N=void 0===P?600:P,w=e.enableScrollTop,M=void 0===w||w,C=e.multilineDelimiter,q=void 0===C?null:C,R="",I="",T=!1,L=Object(u.useState)(!1),D=Object(G.a)(L,2),Q=D[0],_=D[1],F=0,H=t.length,W=0,B=0,A=null,V=Math.PI/"".concat(t.length),E=t.length*g,U=t.length*y,z=0,J=0,Y=Math.round(N/2),X=Math.round(k/2.5);Object(u.useEffect)((function(){K(),M&&setTimeout((function(){window.scrollTo(0,1)}),0)}),[]);var K=function(){Z(),te()},Z=function(){var e=document.getElementById("canvas");-1!==navigator.appVersion.indexOf("MSIE")&&((e=document.createElement("canvas")).setAttribute("width",N),e.setAttribute("height",k),e.setAttribute("id","canvas"),document.getElementById("wheel").appendChild(e)),e.addEventListener("click",$,!1),A=e.getContext("2d")},$=function(e){T=!0,0===F&&(z=(new Date).getTime(),V=Math.PI/t.length,J=0,F=setInterval(ee,H)),console.log({maxSpeed:V}),r()},ee=function(){J++,ae();var e=(new Date).getTime()-z,a=0,s=!1;for(e<E?(a=e/E,B=V*Math.sin(a*Math.PI/2)):(n&&R===n&&J>t.length?(a=e/E,B=V*Math.sin(a*Math.PI/2+Math.PI/2),a=1):(a=e/U,B=V*Math.sin(a*Math.PI/2+Math.PI/2)),a>=1&&(s=!0)),W+=B;W>=2*Math.PI;)W-=2*Math.PI;s&&(_(!0),c(R),clearInterval(F),F=0,B=0),i&&i({finished:s,progress:a,frames:J})},te=function(){ie(),se(),re()},ae=function(){ie(),se(),re()},ne=function(e,n,s){var r=A,i=t[e];r.save(),r.beginPath(),r.moveTo(Y,X),r.arc(Y,X,b,n,s,!1),r.lineTo(Y,X),r.closePath(),r.fillStyle=a[e],r.fill(),r.stroke(),r.save(),r.translate(Y,X),r.rotate((n+s)/2),r.fillStyle=l||"white",r.font="bold 1em "+O,q&&-1!==i.indexOf(q)?(r.fillText(i.substr(0,i.indexOf(q)),b/2+25,-3),r.font="0.75em "+O,r.fillText(i.substr(i.indexOf(q)+1,21),b/2+25,11)):r.fillText(i.substr(0,21),b/2+25,0),r.restore()},se=function(){var e=A,a=W,n=t.length,s=2*Math.PI;e.lineWidth=1,e.strokeStyle=o||"black",e.textBaseline="middle",e.textAlign="center",e.font="1em "+O;for(var r=1;r<=n;r++){var i=s*(r/n)+W;ne(r-1,a,i),a=i}e.beginPath(),e.arc(Y,X,50,0,s,!1),e.closePath(),e.fillStyle=o||"black",e.lineWidth=10,e.strokeStyle=l||"white",e.fill(),e.font="bold 1em "+O,e.fillStyle=l||"white",e.textAlign="center",e.fillText(d||"Spin",Y,X+3),e.stroke(),e.beginPath(),e.arc(Y,X,b,0,s,!1),e.closePath(),e.lineWidth=10,e.strokeStyle=o||"black",e.stroke()},re=function(){var e=A;e.lineWidth=1,e.strokeStyle=l||"white",e.fileStyle=l||"white",e.beginPath(),e.moveTo(Y+20,X-50),e.lineTo(Y-20,X-50),e.lineTo(Y,X-70),e.closePath(),e.fill();var a=W+Math.PI/2,n=t.length-Math.floor(a/(2*Math.PI)*t.length)-1;n<0&&(n+=t.length),e.textAlign="center",e.textBaseline="middle",e.fillStyle=o||"black",e.font="bold 1.5em "+O,R=t[n],I=R||"",T&&e.fillText(I,Y+10,X+b+50)},ie=function(){A.clearRect(0,0,N,k)},ce="auto";return Q&&h&&(ce="none"),Object(S.jsx)("div",{id:"wheel",style:{position:"relative"},children:Object(S.jsx)("canvas",{id:"canvas",width:N,height:k,style:{pointerEvents:ce}})})},se=(a(224),a(97)),re=function(e){Object(r.a)(c,e);var t=Object(i.a)(c);function c(e){var a;return Object(n.a)(this,c),(a=t.call(this,e)).changeNextGameIdx=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return!(a.state.nextGameIdx+e>a.state.history.length)&&(!(a.state.nextGameIdx+e<0)&&(a.setState((function(t){return{nextGameIdx:t.nextGameIdx+e}})),!0))},a.changeGameOrder=function(e,t){return!(t>e.length)&&(a.setState({history:e,nextGameIdx:t}),!0)},a.moveNextGameFwd=function(){return a.changeNextGameIdx()},a.moveNextGameBack=function(){return a.changeNextGameIdx(-1)},a.addGameRequest=function(e,t){a.setState((function(n){return Object(b.a)(Object(b.a)({},n),{},{messages:Object(b.a)(Object(b.a)({},a.state.messages),{},Object(p.a)({},e.longName,Object(b.a)(Object(b.a)({},e),{},{username:t,time:Date.now(),locked:!1,chosen:!1}))),counter:a.state.counter+1})}))},a.toggleLock=function(e){var t=Object(b.a)({},a.state.messages[e]);t.locked=!t.locked,a.setState((function(){return Object(b.a)(Object(b.a)({},a.state),{},{messages:Object(b.a)(Object(b.a)({},a.state.messages),{},Object(p.a)({},e,t))})}))},a.setNextGame=function(e){for(var t=a.state.nextGameIdx;t<a.state.history.length&&(null===(n=a.state.history[t])||void 0===n?void 0:n.override);){var n;t++}return a.setState((function(a){return Object(b.a)(Object(b.a)({},a),{},{history:[].concat(Object(h.a)(a.history.slice(0,Math.max(0,t))),[Object(b.a)(Object(b.a)({},e),{},{override:!0,time:Date.now()})],Object(h.a)(a.history.slice(t)))})})),t-a.state.nextGameIdx},a.addGameToQueue=function(e){a.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{gameSelected:e,history:[].concat(Object(h.a)(a.state.history),[Object(b.a)(Object(b.a)({},e),{},{override:!1})]),messages:Object(b.a)(Object(b.a)({},t.messages),{},Object(p.a)({},e.longName,Object(b.a)(Object(b.a)({},t.messages[e.longName]),{},{chosen:!0})))})}))},a.clearModal=function(){a.setState({gameSelected:null})},a.getGamesList=function(){var e,t;return{allowedGames:null===(e=a.messageHandler)||void 0===e?void 0:e.state.allowedGames,validGames:null===(t=a.messageHandler)||void 0===t?void 0:t.state.validGames}},a.onWheelSpun=function(e){var t,n=null===(t=a.state.messages)||void 0===t?void 0:t[e];if(n){var s=n.username;return a.addGameToQueue(n),a.state.messages[e].locked||setTimeout((function(){a.removeGame(e),a.clearModal()}),4e3),a.chatActivity.getStatusPromise(s).then((function(e){var t="";switch(e){case x:t="/me ".concat(n.name," just won the spin, but it doesn't seem like @").concat(s," is still around. Hope someone else wants to play!");break;case v:t="/me @".concat(s,", good news - ").concat(n.name," just won the spin!");break;case O:default:t="/me @".concat(s,", good news - ").concat(n.name," just won the spin! (I hope you're still around!)")}return a.messageHandler.sendMessage(t)}))}},a.removeGame=function(e){var t=Object(b.a)({},a.state.messages);delete t[e],a.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{messages:t,counter:a.state.counter+1})}))},a.onMessage=function(e,t,n){a.chatActivity.updateLastMessageTime(t)},a.toggleOptionsModal=function(){a.setState((function(e){return{showOptionsModal:!e.showOptionsModal}}))},a.togglePlayerSelect=function(){a.setState((function(e){return{showPlayerSelect:!e.showPlayerSelect}}))},a.routePlayRequest=function(e,t){var n,s,r=t.sendConfirmationMsg,i=void 0===r||r,c=t.isPrioritySeat,o=void 0!==c&&c,l=a.state.showPlayerSelect?null===(n=a.playerSelector)||void 0===n?void 0:n.handleNewPlayerRequest(e,{isPrioritySeat:o}):"sign-ups are currently closed; try again after this game wraps up!";i&&(null===(s=a.messageHandler)||void 0===s||s.sendMessage("/me @".concat(e,", ").concat(l)))},a.routeLeaveRequest=function(e){var t;null===(t=a.playerSelector)||void 0===t||t.removeUser(e)},a.routeOpenQueueRequest=function(){var e;a.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{showPlayerSelect:!0})})),null===(e=a.playerSelector)||void 0===e||e.openQueue()},a.routeCloseQueueRequest=function(){var e;null===(e=a.playerSelector)||void 0===e||e.closeQueue()},a.routeClearQueueRequest=function(){var e;null===(e=a.playerSelector)||void 0===e||e.clearQueue()},a.startGame=function(){return!!a.state.showPlayerSelect&&(a.togglePlayerSelect(),a.moveNextGameFwd(),!0)},a.setMessageHandlerRef=function(e){a.messageHandler=e},a.setPlayerSelectRef=function(e){a.playerSelector=e},a.renderOptionsModal=function(){var e,t=a.messageHandler.state,n=t.allowedGames,s=t.validGames,r=(e=[]).concat.apply(e,Object(h.a)(Object.entries(s).map((function(e,t){return Object.keys(e[1]).map((function(t){return{id:"".concat(e[0]," ").concat(t).replace(/\W/gi,"_"),game:t,pack:e[0]}}))}))));return console.log("gamePackList:",r,n),Object(S.jsxs)(z.a,{show:a.state.showOptionsModal,onHide:a.toggleOptionsModal,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(S.jsx)(z.a.Header,{closeButton:!0,children:Object(S.jsx)(z.a.Title,{id:"contained-modal-title-vcenter",children:"Modal heading"})}),Object(S.jsxs)(z.a.Body,{children:[Object(S.jsx)("h4",{children:"Options"}),Object(S.jsx)("div",{className:"options-list",children:Object(S.jsx)("ul",{children:r.map((function(e,t){var a=e.id,n=e.game,s=e.pack;return Object(S.jsxs)("li",{children:[Object(S.jsx)("input",{type:"checkbox",id:a,name:a,value:a})," ",Object(S.jsxs)("label",{htmlFor:a,children:[s,": ",n]})]},a)}))})})]}),Object(S.jsx)(z.a.Footer,{children:Object(S.jsx)(J.a,{onClick:a.toggleOptionsModal,children:"Close"})})]})},a.chatActivity=new k(a.props.channel),a.state={gameSelected:null,messages:{},colors:se({count:99,luminosity:"light",hue:"blue"}),counter:0,history:[],nextGameIdx:0,showPlayerSelect:!1,showOptionsModal:!1},a.playerSelector=null,a.messageHandler=null,a.changeNextGameIdx=a.changeNextGameIdx.bind(Object(d.a)(a)),a.moveNextGameFwd=a.moveNextGameFwd.bind(Object(d.a)(a)),a.moveNextGameBack=a.moveNextGameBack.bind(Object(d.a)(a)),a.addGameRequest=a.addGameRequest.bind(Object(d.a)(a)),a.toggleLock=a.toggleLock.bind(Object(d.a)(a)),a.setNextGame=a.setNextGame.bind(Object(d.a)(a)),a.addGameToQueue=a.addGameToQueue.bind(Object(d.a)(a)),a.onWheelSpun=a.onWheelSpun.bind(Object(d.a)(a)),a.removeGame=a.removeGame.bind(Object(d.a)(a)),a.onMessage=a.onMessage.bind(Object(d.a)(a)),a.togglePlayerSelect=a.togglePlayerSelect.bind(Object(d.a)(a)),a.routePlayRequest=a.routePlayRequest.bind(Object(d.a)(a)),a.routeLeaveRequest=a.routeLeaveRequest.bind(Object(d.a)(a)),a.routeOpenQueueRequest=a.routeOpenQueueRequest.bind(Object(d.a)(a)),a.routeCloseQueueRequest=a.routeCloseQueueRequest.bind(Object(d.a)(a)),a.routeClearQueueRequest=a.routeClearQueueRequest.bind(Object(d.a)(a)),a.startGame=a.startGame.bind(Object(d.a)(a)),a.setMessageHandlerRef=a.setMessageHandlerRef.bind(Object(d.a)(a)),a.setPlayerSelectRef=a.setPlayerSelectRef.bind(Object(d.a)(a)),a}return Object(s.a)(c,[{key:"componentDidMount",value:function(){a(225),-1!==window.location.hash.indexOf("fakestate=true")&&(-1!==window.location.hash.indexOf("playerselect=true")?this.setState(Object.assign({},H,{showPlayerSelect:!0})):this.setState(H))}},{key:"renderGameChosenModal",value:function(e){var t,a=this,n={force:.6,duration:3500,particleCount:100,floorHeight:Math.max(window.outerWidth,window.outerHeight),floorWidth:Math.max(window.outerWidth,window.outerHeight)};return e.username&&(t=Object(S.jsxs)("h4",{children:["requested by @",e.username]})),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"overlay fade-in-out",children:Object(S.jsx)("div",{className:"confetti-wrapper",children:Object(S.jsx)(g.a,Object(b.a)({},n))})}),Object(S.jsxs)("div",{className:"confetti-modal modal-game-chosen fade-in-out",onClick:function(){return a.removeGame(e.longName)},children:[Object(S.jsx)("h1",{children:e.name}),t]})]})}},{key:"render",value:function(){var e,t,a,n=this,s=Object.keys(this.state.messages);this.state.gameSelected?e=this.renderGameChosenModal(this.state.gameSelected):this.state.showOptionsModal&&(e=this.renderOptionsModal()),"function"===typeof this.props.onLogout&&(t=Object(S.jsx)("button",{className:"btn btn-sm float-end logout",onClick:this.props.onLogout,children:"Logout \u27a7"})),-1!==window.location.hash.indexOf("options=true")&&(a=Object(S.jsx)("button",{className:"btn btn-sm float-start options",onClick:this.toggleOptionsModal,children:"Options"}));var r,i,c,o=this.state.showPlayerSelect?"player-select":"game-select",l=this.state.showPlayerSelect?Object(S.jsxs)("span",{className:"subheading-player fade-in-delay",children:["Type ",Object(S.jsx)("b",{children:"!new"})," in ",this.props.channel,"'s chat if you want to join the next game"]}):Object(S.jsxs)("span",{className:"subheading-game fade-in-delay",children:["Type e.g. ",Object(S.jsx)("b",{children:'"!request Blather Round"'})," in ",this.props.channel,"'s chat to add"]});this.state.showPlayerSelect?r=Object(S.jsx)(te,{game:null===(c=this.state.history)||void 0===c?void 0:c[this.state.nextGameIdx],startGame:this.startGame,ref:this.setPlayerSelectRef}):(r=s.map((function(e,t){return Object(S.jsx)(Z,{gameName:e,metadata:n.state.messages[e],onDelete:n.removeGame,toggleLock:n.toggleLock.bind(e),getActivity:n.chatActivity.getStatusPromise},t)})),i=Object(S.jsx)("div",{className:"right-column",width:"50px",children:Object(S.jsx)("div",{className:"wheel-wrapper fade-in",children:Object(S.jsx)(ne,{segments:s,segColors:this.state.colors,onFinished:this.onWheelSpun,isOnlyOnce:!1,size:250,upDuration:100,downDuration:1e3,primaryColor:"white",contrastColor:"black",fontFamily:"Arial",multilineDelimiter:" ("},this.state.counter)})}));return Object(S.jsxs)("div",{id:"main-screen",className:o,children:[Object(S.jsxs)("nav",{className:"main-screen-nav",children:[a,t]}),Object(S.jsx)(Q,{addGameRequest:this.addGameRequest,setNextGame:this.setNextGame,changeNextGameIdx:this.changeNextGameIdx,startGame:this.startGame,messages:this.state.messages,channel:this.props.channel,modList:this.props.modList,access_token:this.props.access_token,onMessage:this.onMessage,onDelete:this.removeGame,upcomingGames:this.state.history.slice(this.state.nextGameIdx),caniplayHandler:this.routePlayRequest,playerExitHandler:this.routeLeaveRequest,openQueueHandler:this.routeOpenQueueRequest,closeQueueHandler:this.routeCloseQueueRequest,clearQueueHandler:this.routeClearQueueRequest,ref:this.setMessageHandlerRef}),Object(S.jsxs)("div",{className:"left-column fade-in",children:[Object(S.jsx)("h1",{children:this.state.showPlayerSelect?"Seat Requests":"Game Requests"}),Object(S.jsx)("h4",{children:l}),Object(S.jsxs)("div",{className:"left-column-body",children:[Object(S.jsx)(ae,{changeGameOrder:this.changeGameOrder,history:this.state.history,nextGameIdx:this.state.nextGameIdx,changeNextGameIdx:this.changeNextGameIdx,moveNextGameFwd:this.moveNextGameFwd,moveNextGameBack:this.moveNextGameBack,togglePlayerSelect:this.togglePlayerSelect,requestMode:this.state.showPlayerSelect?"seat":"game"}),Object(S.jsx)("div",{className:"left-column-inner-body",children:r})]})]}),i,e]})}}]),c}(u.Component),ie=a(19),ce=a(103),oe=a.n(ce),le=a(65),de=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).state={username:localStorage.getItem("__username"),access_token:localStorage.getItem("__access_token"),failed_login:!1},e.getAuth=e.getAuth.bind(Object(d.a)(e)),e.getUsers=e.getUsers.bind(Object(d.a)(e)),e.logOut=e.logOut.bind(Object(d.a)(e)),e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;return this._isMounted=!0,this.state.access_token?this.getUsers(this.state.access_token).catch((function(t){return console.error(t),e.getAuth(t)})):this.getAuth()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"getAuth",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,s=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&console.error(t),localStorage.removeItem("__username"),localStorage.removeItem("__access_token"),a=oe.a.parse(this.props.location.search),n=new URLSearchParams({grant_type:"authorization_code",code:a.code,client_id:"u172q64ekv1j8nxy1r48mb8vn4kk7v",client_secret:"7yfmbc5ka6t7frki5g8m0qsboltp2p",redirect_uri:"https://asukii314.github.io/twitch-request-wheel/#"}),e.next=7,le("https://id.twitch.tv/oauth2/token?".concat(n),{method:"POST",headers:{Accept:"application/vnd.twitchtv.v5+json"}}).then((function(e){return e.json()})).then((function(e){if(s._isMounted)return e.access_token?(localStorage.setItem("__access_token",e.access_token),s.setState({access_token:e.access_token}),s.getUsers(e.access_token)):s.setState({failed_login:!0})})).catch((function(e){if(console.error(e),s._isMounted)return s.setState({failed_login:!0})}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUsers",value:function(e){var t=this;return le("https://api.twitch.tv/helix/users",{headers:{"Client-ID":"u172q64ekv1j8nxy1r48mb8vn4kk7v",Authorization:"Bearer ".concat(this.state.access_token)}}).then((function(e){return e.json()})).then((function(e){return localStorage.setItem("__username",e.data[0].login),le("https://api.twitch.tv/helix/moderation/moderators?broadcaster_id=".concat(e.data[0].id),{headers:{"Client-ID":"u172q64ekv1j8nxy1r48mb8vn4kk7v",Authorization:"Bearer ".concat(t.state.access_token)}}).then((function(e){return e.json()})).then((function(a){var n=a.data?a.data.map((function(e){return e.user_name?e.user_name.toLowerCase():null})).filter((function(e){return e})):null;if(t._isMounted)return t.setState({username:e.data[0].login,modList:n})}))}))}},{key:"logOut",value:function(){localStorage.removeItem("__username"),localStorage.removeItem("__access_token");var e=new URLSearchParams({client_id:"u172q64ekv1j8nxy1r48mb8vn4kk7v",token:this.state.access_token,redirect_uri:"https://asukii314.github.io/twitch-request-wheel/#"});return le("https://id.twitch.tv/oauth2/revoke?".concat(e),{method:"POST",headers:{Accept:"application/vnd.twitchtv.v5+json"}}).then((function(){return window.location.reload()}))}},{key:"render",value:function(){if(this.state.failed_login)return Object(S.jsx)(ie.a,{to:"/login"});var e,t=["authenticated-app"];return this.state.username&&(-1!==window.location.hash.indexOf("legacy=true")?(t.push("legacy"),e=Object(S.jsx)(U,{channel:this.state.username,modList:this.state.modList,access_token:this.state.access_token,onLogout:this.logOut})):(t.push("beta"),e=Object(S.jsx)(re,{channel:this.state.username,modList:this.state.modList,access_token:this.state.access_token,onLogout:this.logOut}))),Object(S.jsx)("div",{id:t.join(" "),children:e})}}]),a}(u.Component),ue=Object(ie.g)(de),me=a(51),he=(a(230),a(65)),pe=function(e){var t=Object.keys(e.metadata);return Object(S.jsxs)("div",{className:"partyPackCard",children:[Object(S.jsxs)("p",{className:"partyPackName",children:[e.partyPackName," "]}),t.map((function(t,a){var n,s;return Object(S.jsx)(be,{gameName:t,possibleMatches:null===(n=e.metadata)||void 0===n||null===(s=n[t])||void 0===s?void 0:s.Variants},a)}))]})},be=function(e){return Object(S.jsxs)("div",{className:"mt-2 lh-sm",children:[Object(S.jsxs)("p",{className:"gameName",children:[e.gameName," "]}),e.possibleMatches.map((function(t,a){return Object(S.jsxs)("li",{className:"possibleGameMatch",children:["!request ",t]},"".concat(e.gameName,"-").concat(a))}))]})},fe=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).state={validGames:[]},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(e){var t=this;he(C).then((function(e){return e.text()})).then((function(e){t.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{validGames:R.a.parse(e)})}))}))}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.validGames);return Object(S.jsx)("div",{className:"partyPackList",children:t.map((function(t,a){return Object(S.jsx)(pe,{partyPackName:t,metadata:e.state.validGames[t]},a)}))})}}]),a}(u.Component),ge=a(104),je=(a(231),"https://id.twitch.tv/oauth2/authorize"+"?client_id=".concat("u172q64ekv1j8nxy1r48mb8vn4kk7v")+"&response_type=code&scope=".concat("chat:read chat:edit moderation:read")+"&redirect_uri=".concat("https://asukii314.github.io/twitch-request-wheel/%23")),ye=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(S.jsxs)("div",{id:"login-screen",className:"fade-in",children:[Object(S.jsxs)("a",{href:je,className:"btn btn-sm fs-2",children:["Log In With ",Object(S.jsx)("strong",{children:"Twitch"})]}),Object(S.jsx)("br",{}),Object(S.jsx)("small",{children:"v".concat(ge.a)})]})}}]),a}(u.Component),ve=(a(232),function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=["App"];return-1!==window.location.hash.indexOf("legacy=true")&&e.push("legacy"),Object(S.jsx)(me.b,{basename:"/",children:Object(S.jsx)("div",{className:e.join(" "),children:Object(S.jsxs)(ie.d,{children:[Object(S.jsx)(ie.b,{exact:!0,path:"/login",component:ye}),Object(S.jsx)(ie.b,{exact:!0,path:"/gamelist",component:fe}),Object(S.jsx)(ie.b,{path:"/",component:ue})]})})})}}]),a}(u.Component)),Oe=a(22),xe=a(40),ke=function(e){e&&e instanceof Function&&(Object(xe.a)(e),Object(xe.c)(e),Object(xe.b)(e),Object(xe.d)(e),Object(xe.e)(e))};a(233);Object(Oe.render)(Object(S.jsx)(m.a.StrictMode,{children:Object(S.jsx)(me.a,{children:Object(S.jsx)(ve,{})})}),document.getElementById("root")),ke()},95:function(e,t){}},[[235,1,2]]]);
//# sourceMappingURL=main.0c41ea5f.chunk.js.map