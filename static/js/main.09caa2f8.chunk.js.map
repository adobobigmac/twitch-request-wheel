{"version":3,"sources":["lock.svg","MessageHandler.js","AuthenticatedApp.js","App.js","reportWebVitals.js","index.js"],"names":["randomColor","require","tmi","GAME_REQUEST_COMMAND","GameRequest","props","updateTimeDiff","setState","state","timeDiff","Math","floor","Date","now","metadata","time","delete","e","onDelete","msg","toggleLock","lockOpacity","this","locked","effect","place","id","data-tip","username","style","backgroundColor","textAlign","borderRadius","textTransform","onMouseEnter","margin","padding","fontSize","display","justifyContent","alignItems","src","lock","width","opacity","paddingRight","className","onClick","type","Component","MessageHandler","game","stateCopy","messages","console","log","onGameChosen","removeGame","newMessageObj","counter","onMessage","target","tags","self","message","startsWith","replace","trim","toLowerCase","filterGameCommands","sendMessage","client","say","channel","colors","count","luminosity","hue","identity","password","access_token","channels","on","connect","JSON","stringify","gameArray","Object","keys","marginBottom","color","marginTop","fontWeight","map","i","bind","overflow","segments","segColors","onFinished","isOnlyOnce","size","upDuration","downDuration","primaryColor","contrastColor","fetch","AuthenticatedApp","failed_login","a","queryParams","queryString","parse","location","search","URLSearchParams","grant_type","code","client_id","process","client_secret","redirect_uri","method","headers","Accept","then","r","json","oauth","Authorization","userInfo","data","login","to","withRouter","loginScreen","loginUrl","href","App","basename","exact","path","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.09caa2f8.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/lock.6857c469.svg\";","import { Component } from 'react';\r\nimport WheelComponent from 'react-wheel-of-prizes'\r\nimport ReactTooltip from 'react-tooltip'\r\nimport './messageStyles.css';\r\nimport lock from './lock.svg';\r\nconst randomColor = require('randomcolor');\r\nconst tmi = require('tmi.js');\r\n\r\nconst GAME_REQUEST_COMMAND = \"!request\";\r\nconst column = function(width) {\r\n  return (<div style={{float:'left', width:width}} />);\r\n}\r\n\r\nconst filterGameCommands = function(message) {\r\n  if(!message.startsWith(GAME_REQUEST_COMMAND)) return;\r\n  return message.replace(GAME_REQUEST_COMMAND, \"\").trim().toLowerCase();\r\n}\r\n\r\n\r\nclass GameRequest extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      timeDiff: 0\r\n    };\r\n  }\r\n\r\n  updateTimeDiff = () => {\r\n    // return Date.now();\r\n    this.setState(() => {\r\n      return {\r\n        ...this.state,\r\n        timeDiff: `${Math.floor((Date.now()-this.props.metadata.time)/60000)} minutes ago`\r\n      };\r\n    });\r\n  }\r\n  delete = (e) => {\r\n    this.props.onDelete(this.props.msg)\r\n  }\r\n\r\n  toggleLock = () => {\r\n    this.props.toggleLock(this.props.msg)\r\n  }\r\n\r\n  render() {\r\n    const lockOpacity = this.props.metadata.locked ? '1' : '0.2';\r\n    return (\r\n      <div>\r\n      <ReactTooltip effect=\"solid\" place=\"right\"/>\r\n      <div id=\"baseDiv\" data-tip={`Requested ${this.state.timeDiff} by ${this.props.metadata.username}`} style={{backgroundColor:'steelblue', textAlign: 'left', borderRadius: '8px', textTransform: 'capitalize'}} onMouseEnter={this.updateTimeDiff}>\r\n      <p style={{margin: '15px', padding: '4px', fontSize: '16px', display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>\r\n        {this.props.msg}\r\n        <div style={{display:'flex'}}>\r\n          <img src={lock} style={{width: '16px', opacity: lockOpacity, paddingRight: '8px'}} className=\"lock\" onClick={this.toggleLock} />\r\n          <button type='button' className=\"deleteButton\" onClick={this.delete}>X</button>\r\n        </div>\r\n      </p>\r\n      </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default class MessageHandler extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      messages: {},\r\n      colors: randomColor({count: 99, luminosity: 'light', hue: 'blue'}),\r\n      counter: 0\r\n    };\r\n  }\r\n\r\n  toggleLock = (game) => {\r\n    const stateCopy = {...this.state.messages[game]};\r\n    console.log(stateCopy)\r\n    stateCopy.locked = !stateCopy.locked\r\n    this.setState(() => {\r\n      return {\r\n        ...this.state,\r\n        messages: {\r\n          ...this.state.messages,\r\n          [game]: stateCopy\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  onGameChosen = (game) => {\r\n    if(!this.state.messages[game].locked) {\r\n      this.removeGame(game);\r\n    }\r\n  }\r\n\r\n  removeGame = (game) => {\r\n    const newMessageObj = {...this.state.messages};\r\n    delete newMessageObj[game];\r\n    this.setState((state) => {\r\n      return {\r\n        ...state,\r\n        messages: newMessageObj,\r\n        counter: this.state.counter + 1\r\n      };\r\n    })\r\n  }\r\n\r\n  onMessage = (target, tags, msg, self) => {\r\n    const game = filterGameCommands(msg);\r\n    if (!game) return;\r\n    if(this.state.messages[game]) {\r\n      this.sendMessage(`/me @${tags.username}, ${game} has already been requested!`);\r\n      return;\r\n    }\r\n\r\n    this.setState((state) => {\r\n      return {\r\n        ...state,\r\n        messages: {\r\n          ...this.state.messages,\r\n          [game]: {\r\n            username: tags.username,\r\n            time: Date.now(),\r\n            locked: false\r\n          }\r\n        },\r\n        counter: this.state.counter + 1\r\n      };\r\n    })\r\n    this.sendMessage(`/me @${tags.username}, ${game} has been added to the request queue.`);\r\n  }\r\n\r\n  sendMessage = (msg) => {\r\n    this.state.client.say(this.props.channel, msg)\r\n  }\r\n\r\n  componentDidMount(props) {\r\n    const client = new tmi.client({\r\n      identity: {\r\n        username: this.props.channel,\r\n        password: this.props.access_token\r\n      },\r\n      channels: [\r\n        this.props.channel\r\n      ]\r\n    });\r\n\r\n    client.on('message', this.onMessage);\r\n    client.connect();\r\n\r\n    console.log(JSON.stringify(client));\r\n\r\n    this.setState((state) => {\r\n      return {\r\n        ...state,\r\n        client\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const gameArray = Object.keys(this.state.messages);\r\n    console.log(this.state.messages);\r\n    return (\r\n      <div style={{display: 'flex'}}>\r\n        <column width=\"50vw\">\r\n          <h2 style={{marginBottom:\"0\"}}>Game Requests</h2>\r\n          <h4 style={{fontSize:\"20px\", color: \"yellow\", marginTop: \"6px\", marginBottom:\"12px\", fontWeight: 400}}>Type e.g. \"!request Blather Round\" in {this.props.channel}'s chat to add</h4>\r\n          {gameArray.map((msg, i) => <GameRequest key={i} msg={msg} metadata={this.state.messages[msg]} onDelete={this.removeGame} toggleLock={this.toggleLock.bind(msg)}/>)}\r\n        </column>\r\n        <column width=\"50vw\" style={{textTransform: 'capitalize'}}>\r\n          <div style={{fontSize: \"16px\", overflow: \"hidden\", width: \"600px\"}}>\r\n            <WheelComponent\r\n              key={this.state.counter}\r\n              segments={gameArray}\r\n              segColors={this.state.colors}\r\n              onFinished={this.onGameChosen}\r\n              isOnlyOnce={false}\r\n              size={250}\r\n              upDuration={100}\r\n              downDuration={1000}\r\n              primaryColor={\"white\"}\r\n              contrastColor={\"black\"}\r\n            />\r\n          </div>\r\n        </column>\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","\r\nimport React, { Component } from 'react';\r\nimport MessageHandler from './MessageHandler';\r\nimport { Redirect, withRouter } from \"react-router-dom\";\r\nimport queryString from 'query-string'\r\nconst fetch = require('node-fetch');\r\n\r\nclass AuthenticatedApp extends Component {\r\n  constructor(){\r\n    super();\r\n    this.state = {\r\n      username: \"\",\r\n      access_token: \"\",\r\n      failed_login: false\r\n    }\r\n  }\r\n  async componentDidMount() {\r\n    const queryParams = queryString.parse(this.props.location.search);\r\n    await fetch('https://id.twitch.tv/oauth2/token?' + new URLSearchParams({\r\n      grant_type: 'authorization_code',\r\n      code: queryParams.code,\r\n      client_id: process.env.REACT_APP_TWITCH_CLIENT_ID,\r\n      client_secret: process.env.REACT_APP_TWITCH_CLIENT_SECRET,\r\n      redirect_uri: process.env.REACT_APP_REDIRECT_URI_NOENCODE\r\n    }), {\r\n      method: 'POST',\r\n      headers: {\r\n        Accept: 'application/vnd.twitchtv.v5+json'\r\n      }\r\n    }).then(r => r.json())\r\n    .then((oauth) => {\r\n      //console.log(oauth); // access_token, refresh_token, expires_in, scope ['...']\r\n      if(!oauth.access_token) {\r\n        this.setState((state) => {\r\n          return {\r\n            ...state,\r\n            failed_login: true\r\n          };\r\n        });\r\n        return;\r\n      }\r\n\r\n      this.setState((state) => {\r\n        return {\r\n          ...state,\r\n          access_token: oauth.access_token\r\n        };\r\n      });\r\n\r\n      fetch('https://api.twitch.tv/helix/users', {\r\n        headers: {\r\n          'Client-ID': process.env.REACT_APP_TWITCH_CLIENT_ID,\r\n          Authorization: `Bearer ${oauth.access_token}`\r\n        }\r\n      })\r\n      .then(r => r.json())\r\n      .then(userInfo => {\r\n        //console.log(userInfo); //login [aka lowercase username?], display_name, profile_image_url, description\r\n        this.setState((state) => {\r\n          return {\r\n            ...state,\r\n            username: userInfo.data[0].login,\r\n          };\r\n        })\r\n      })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <p>\r\n        {this.state.failed_login\r\n          ? <Redirect to=\"/login\" />\r\n          : this.state.username && <MessageHandler channel={this.state.username} access_token={this.state.access_token} />}\r\n      </p>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nexport default withRouter(AuthenticatedApp);\r\n","// import logo from './logo.svg';\nimport './App.css';\nimport AuthenticatedApp from './AuthenticatedApp';\nimport React, { Component } from 'react';\nimport { HashRouter, Route } from \"react-router-dom\";\n\nconst loginScreen = function() {\n  const loginUrl = `https://id.twitch.tv/oauth2/authorize?client_id=${process.env.REACT_APP_TWITCH_CLIENT_ID}&response_type=code&scope=chat:read chat:edit&redirect_uri=${process.env.REACT_APP_REDIRECT_URI}`\n  return (\n    <a href={loginUrl} style={{backgroundColor: 'rebeccapurple', borderRadius: '5px', padding: '10px', color: 'white'}}>Log In With Twitch</a>\n  );\n}\n\nclass App extends Component {\n  render() {\n\n    return (\n      <HashRouter basename='/'>\n        <div className=\"App\">\n          <header className=\"App-header\">\n            <Route exact path=\"/login\">\n              {loginScreen()}\n            </Route>\n            <Route path=\"/\" component={AuthenticatedApp} />\n          </header>\n        </div>\n      </HashRouter>\n    );\n  }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from \"react-router-dom\";\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}